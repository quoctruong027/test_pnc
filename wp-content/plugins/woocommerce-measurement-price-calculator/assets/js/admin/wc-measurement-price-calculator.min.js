"use strict";jQuery(function(n){var e=!1;function i(){e?t(1<=_.find(".woocommerce_variations .checkbox.variable_manage_stock:checked").length):wc_price_calculator_admin_params.is_variable_product_with_stock_managed&&t(!0)}function t(e){var t=n("p.stock_fields");e?t.show():t.hide()}function c(){var a=new RegExp(/\(([^)]+)\)/),r="("+String(wc_price_calculator_admin_params.woocommerce_currency_symbol)+")",e=n('label[for="_regular_price"]');e.html(e.html().replace(a,r));e=n('label[for="_sale_price"]');e.html(e.html().replace(a,r)),n('.woocommerce_variable_attributes input[type="text"]').each(function(e,t){!(t=n(t)).attr("name")||"variable_price"!==t.attr("name").substr(0,14)&&"variable_regular_price"!==t.attr("name").substr(0,22)&&"variable_sale_price"!==t.attr("name").substr(0,19)||t.prev().html(t.prev().html().replace(a,r))})}function a(){var e=n('label[for="_stock"]').text();-1!==e.indexOf("(")&&(e=e.substr(0,e.indexOf("(")-1),n('label[for="_stock"]').text(e)),n('.woocommerce_variable_attributes input[type="number"]').each(function(e,t){var a;"variable_stock"!==(t=n(t)).attr("name").substr(0,14)||-1!==(a=t.prev().text()).indexOf("(")&&(a=a.substr(0,a.indexOf("(")-1)+":",t.prev().text(a))})}function l(){var e=n('label[for="_weight"]').text().substr(0,n('label[for="_weight"]').text().indexOf("("))+"("+wc_price_calculator_admin_params.woocommerce_weight_unit+")";n('label[for="_weight"]').text(e),n('.woocommerce_variable_attributes input[type="number"]').each(function(e,t){var a;"variable_weight"!==(t=n(t)).attr("name").substr(0,15)||-1!==(a=t.prev().text()).indexOf("(")&&(a=a.substr(0,a.indexOf("(")-1),t.prev().text(a))})}function r(){n("._weight_field").show(),n('.woocommerce_variable_attributes input[type="number"]').each(function(e,t){"variable_weight"===(t=n(t)).attr("name").substr(0,15)&&t.prev().show()})}n("input#_manage_stock").change(function(){t(n(this).is(":checked")),n("._measurement_pricing_calculator_enabled").trigger("change")}).change();var _=n("#variable_product_options");function s(){n(".measurement_description").hide(),n(".measurement_fields").hide()}function o(e){(e&&0<n(".wc-calculator-pricing-table tbody tr").length?function(){""!==n("#_regular_price").val()&&n("#_regular_price").data("orig-value",n("#_regular_price").val()).val("");n("#_regular_price").closest(".form-field").hide(),""!==n("#_sale_price").val()&&n("#_sale_price").data("orig-value",n("#_sale_price").val()).val("");n("#_sale_price").closest(".form-field").hide(),n('.woocommerce_variable_attributes input[type="text"], .woocommerce_variable_attributes input[type="number"]').each(function(e,t){!(t=n(t)).attr("name")||"variable_price"!==t.attr("name").substr(0,14)&&"variable_regular_price"!==t.attr("name").substr(0,22)&&"variable_sale_price"!==t.attr("name").substr(0,19)||(t.prop("readonly",!0),n(".pricing-rules-enabled-notice."+t.attr("id")).length||t.after('<small class="pricing-rules-enabled-notice '+t.attr("id")+'">'+wc_price_calculator_admin_params.pricing_rules_enabled_notice+"</small>"),""!==t.val()&&t.data("orig-value",t.val()))})}:function(){void 0!==n("#_regular_price").data("orig-value")&&""!==n("#_regular_price").data("orig-value")&&(n("#_regular_price").val(n("#_regular_price").data("orig-value")),n("#_regular_price").data("orig-value",""));n("#_regular_price").closest(".form-field").show(),void 0!==n("#_sale_price").data("orig-value")&&""!==n("#_sale_price").data("orig-value")&&(n("#_sale_price").val(n("#_sale_price").data("orig-value")),n("#_sale_price").data("orig-value",""));n("#_sale_price").closest(".form-field").show(),n('.woocommerce_variable_attributes input[type="text"], .woocommerce_variable_attributes input[type="number"]').each(function(e,t){!(t=n(t)).attr("name")||"variable_price"!==t.attr("name").substr(0,14)&&"variable_regular_price"!==t.attr("name").substr(0,22)&&"variable_sale_price"!==t.attr("name").substr(0,19)||(t.prop("readonly",!1),n(".pricing-rules-enabled-notice").remove(),void 0!==t.data("orig-value")&&""!==t.data("orig-value")&&(t.val(t.data("orig-value")),t.data("orig-value","")))})})()}function u(){var a=0;n("table.wc-calculator-pricing-table tbody tr").each(function(e,t){n("input",t).each(function(e,t){t=jQuery(t);t.attr("name",t.attr("name").replace(/\[([^[]*)\]/,"["+a+"]"))}),a++})}_.on("change",".woocommerce_variations .checkbox.variable_manage_stock",i),i(),n("._measurement_pricing").change(function(){"_measurement_"+n("#_measurement_price_calculator").val()+"_pricing"===n(this).attr("id")&&(n(this).is(":checked")?n(this).closest("div.measurement_fields").find("._measurement_pricing_fields").show():n(this).closest("div.measurement_fields").find("._measurement_pricing_fields").hide(),n(this).closest("div").find("._measurement_pricing_calculator_enabled").change())}),n("._measurement_pricing_calculator_enabled").change(function(){var e,a,r,t;i(),"_measurement_"+n("#_measurement_price_calculator").val()+"_pricing_calculator_enabled"===n(this).attr("id")&&(n(this).closest("div.measurement_fields").find("._measurement_pricing").is(":checked")&&n(this).is(":checked")?(e=n(this).closest("div").find("._measurement_pricing_unit option:selected").text(),a=String(wc_price_calculator_admin_params.woocommerce_currency_symbol),r=a+" / "+e,(t=n('label[for="_regular_price"]')).html(t.html().replace(a,r)),(t=n('label[for="_sale_price"]')).html(t.html().replace(a,r)),n('.woocommerce_variable_attributes input[type="text"], .woocommerce_variable_attributes input[type="number"]').each(function(e,t){!(t=n(t)).attr("name")||"variable_price"!==t.attr("name").substr(0,14)&&"variable_regular_price"!==t.attr("name").substr(0,22)&&"variable_sale_price"!==t.attr("name").substr(0,19)||t.prev().html(t.prev().html().replace(a,r))}),(t=n(".wc-calculator-pricing-table .measurement-range-column span.column-title")).text(t.data("text")+" ("+e+")"),(t=n(".wc-calculator-pricing-table .price-per-unit-column span.column-title")).text(t.data("text")+" ("+wc_price_calculator_admin_params.woocommerce_currency_symbol+" / "+e+")"),(t=n(".wc-calculator-pricing-table .sale-price-per-unit-column span.column-title")).text(t.data("text")+" ("+wc_price_calculator_admin_params.woocommerce_currency_symbol+" / "+e+")"),n(this).closest("div.measurement_fields").find("._measurement_editable").attr("checked","checked").attr("disabled","disabled"),n(this).closest("div.measurement_fields").find("._measurement_pricing_calculator_fields").each(function(e,t){t=n(t);t.hasClass("stock_fields")&&!n("input#_manage_stock").is(":checked")||t.show()}),n(".wc-measurement-price-calculator-pricing-table").removeClass("disabled"),o(!0),n(".show_if_pricing_calculator").show()):(c(),n(this).closest("div.measurement_fields").find("._measurement_editable").is(":disabled")&&n(this).closest("div.measurement_fields").find("._measurement_editable").removeAttr("disabled"),n(this).closest("div.measurement_fields").find("._measurement_pricing_calculator_fields").hide(),n(".wc-measurement-price-calculator-pricing-table").addClass("disabled"),o(!1),n(".show_if_pricing_calculator").hide()),(e=n(this).closest("div")).find("._measurement_pricing_inventory_enabled").trigger("change"),e.find("._measurement_pricing_weight_enabled").trigger("change"),e.closest(".measurement_fields").find("._measurement_accepted_input").trigger("change"))}),n("#measurement_product_data").on("change","._measurement_accepted_input",function(){var e,t=n(this),a=t.data(),r=a[t.val()],i=n(this).closest("div"),t=n("#_measurement_"+n("#_measurement_price_calculator").val()+"_pricing_calculator_enabled").is(":checked"),c=[];for(e in a)a.hasOwnProperty(e)&&c.push(a[e]);i=i.find(c.join(",")).hide();t&&i.filter(r).show()}).on("click","._measurement_input_attributes label",function(){n(this).closest("p").find(".wrap input:first-child").trigger("focus")}),setTimeout(function(){var e=window.location.hash;if(null!==e.match(/\#[a-z0-9\-]+/))try{n('a[href="'+e+'"]').trigger("click")}catch(e){}},250),n("select._measurement_accepted_input").on("change",function(){var e=n(this).closest("p").next(),t=e.next();("free"===n(this).val()?t:e).find("input").val("")}),n("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){n("#_measurement_"+n("#_measurement_price_calculator").val()+"_pricing_calculator_enabled").change(),e=!0}),n("._measurement_pricing_inventory_enabled").change(function(){"_measurement_"+n("#_measurement_price_calculator").val()+"_pricing_inventory_enabled"===n(this).attr("id")&&(n("#_measurement_"+n("#_measurement_price_calculator").val()+"_pricing_calculator_enabled").is(":checked")&&n(this).is(":checked")?function(r){a();var e=n('label[for="_stock"]').text()+" ("+r+")";n('label[for="_stock"]').text(e),n('.woocommerce_variable_attributes input[type="number"]').each(function(e,t){var a;"variable_stock"===(t=n(t)).attr("name").substr(0,14)&&(a=t.prev().text().indexOf(":"),a=t.prev().text().substr(0,a)+" ("+r+"):",t.prev().text(a))})}(n(this).closest("div").find("._measurement_pricing_unit option:selected").text()):a())}),n("._measurement_pricing_weight_enabled").change(function(){wc_price_calculator_admin_params.woocommerce_weight_unit&&"_measurement_"+n("#_measurement_price_calculator").val()+"_pricing_weight_enabled"===n(this).attr("id")&&(n("#_measurement_"+n("#_measurement_price_calculator").val()+"_pricing_calculator_enabled").is(":checked")&&n(this).is(":checked")?"weight"===n("#_measurement_price_calculator").val()?(n("._weight_field").hide(),n('.woocommerce_variable_attributes input[type="number"]').each(function(e,t){"variable_weight"===(t=n(t)).attr("name").substr(0,15)&&t.prev().hide()})):(r(),function(r){l();var e=n('label[for="_weight"]').text().substr(0,n('label[for="_weight"]').text().indexOf("("))+"("+wc_price_calculator_admin_params.woocommerce_weight_unit+" / "+r+")";n('label[for="_weight"]').text(e),n('.woocommerce_variable_attributes input[type="number"]').each(function(e,t){var a;"variable_weight"===(t=n(t)).attr("name").substr(0,15)&&(a=t.prev().text()+" ("+wc_price_calculator_admin_params.woocommerce_weight_unit+" / "+r+")",t.prev().text(a))})}(n(this).closest("div").find("._measurement_pricing_unit option:selected").text())):(r(),l()))}),n(".woocommerce_variations").bind("woocommerce_variations_added",function(){n("._measurement_pricing").change()}),n("._measurement_pricing_unit").change(function(){n("._measurement_pricing").change()}),n("#_measurement_price_calculator").change(function(){var e=n(this).val();s(),n(".wc-measurement-price-calculator-pricing-table").addClass("disabled"),n("._measurement_pricing").change(),e?(n("#"+e+"_measurements").show().find("._measurement_accepted_input").trigger("change"),n("#"+e+"_description").show()):(c(),n(".show_if_pricing_calculator").hide()),"dimension"===e&&n("._measurement_dimension").change()}),n("._measurement_dimension").change(function(){n("._measurement_dimension").each(function(e,t){t=n(t).attr("id");n("#"+t).is(":checked")?n("#"+t+"_fields").show():n("#"+t+"_fields").hide()})}),n(".measurement-subnav a").click(function(){var e=n(this);return n(this).hasClass("disabled")||(n(".measurement-subnav a").removeClass("active"),e.addClass("active"),n(".calculator-subpanel").hide(),n(e.attr("href")).show()),!1}).eq(0).click(),n("button.wc-calculator-pricing-table-add-rule").click(function(){var e=n("table.wc-calculator-pricing-table tbody tr").length;n("table.wc-calculator-pricing-table > tbody").append('<tr class="wc-calculator-pricing-rule"><td class="check-column"><input type="checkbox" name="select" /></td>\t\t\t<td class="wc-calculator-pricing-rule-range"><input type="text" name="_wc_measurement_pricing_rule_range_start['+e+']" value="" /> - <input type="text" name="_wc_measurement_pricing_rule_range_end['+e+']" value="" /></td>\t\t\t<td><input type="text" name="_wc_measurement_pricing_rule_regular_price['+e+']" value="" /></td>\t\t\t<td><input type="text" name="_wc_measurement_pricing_rule_sale_price['+e+']" value="" /></td></tr>'),o(!0),u()}),n("button.wc-calculator-pricing-table-delete-rules").click(function(){n("table.wc-calculator-pricing-table td.check-column input:checked").each(function(){n(this).closest("tr.wc-calculator-pricing-rule").fadeOut("400",function(){n(this).remove(),n.queue(this,"fx",function(){o(!0)})})}),n(".wc-calculator-pricing-table thead .check-column input").removeAttr("checked"),o(!0),u()}),n("table.wc-calculator-pricing-table tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td",scrollSensitivity:40,start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style"),u()}}),s(),n("#_measurement_price_calculator").change(),n("._measurement_dimension").change(),n("select#product-type").on("change",function(){n("input#_wc_measurement_price_calculator_min_price").val("")})});