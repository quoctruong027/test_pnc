jQuery(document).ready(function(){new Core.Admin.Main(jQuery(document.body))});
var Core;!function(e){!function(t){var i=function(){function i(t){var n=e.Admin.Helpers.Context.getSlug();this.slug=n,this.parent=t,this.navlinks=this.parent.find(".mabel-nav-tab-wrapper a"),this.tabs=this.parent.find(".mabel-tab"),this.form=this.parent.find("#"+n+"-form"),this.settingsKey=e.Admin.Helpers.Context.getSettingsKey(),this.currentTab=this.parent.find(".mabel-nav-tab-active").data("tab"),this.sidebars=this.parent.find(".mabel-sidebar"),this.mainSidebar=this.sidebars.filter('[data-sidebar-for="main"]'),this.initColorPickers(),this.initDatePickers(),this.initRangeSliders(),this.initTabs(),this.initAccordions(),e.Admin.Helpers.Dependencies.initDependencies(this.settingsKey),this.toggleSidebars(),this.initChangeSettings(),this.initEvents(),i.initChoicePickers()}return i.loading=function(){this.isLoading?jQuery(".mabel-loading").hide():jQuery(".mabel-loading").show(),this.isLoading=!this.isLoading},i.stopLoading=function(){this.isLoading&&(jQuery(".mabel-loading").hide(),this.isLoading=!1)},i.showError=function(e,t){this.stopLoading(),jQuery(".mabel-error-popup-message").empty().append("<h1>"+e+"</h1><p>"+t+"</p>"),jQuery(".mabel-error-popup-wrapper").show()},i.hideError=function(){jQuery(".mabel-error-popup-wrapper").hide()},i.prototype.initDatePickers=function(){function e(e){if(e.indexOf("AM")>-1||e.indexOf("PM")>-1){var t=jQuery.trim(e).split(" ");return t[t.length-2]+" "+t[t.length-1]}var i=new Date,n=i.getHours(),a=i.getMinutes(),r="A'M'";return a<10&&(a="0"+a),12==n?r=" 'PM'":0==n?(n=12,r=" A'M'"):n>12?(n-=12,r=" P'M'"):r=" A'M'"," "+n+":"+a+r}jQuery(".mabel-date-picker").each(function(t,i){var n=jQuery(i),a=n.data("options")||{};n.datepicker(jQuery.extend(a,{dateFormat:"M dd, yy"+e(n.val()),onSelect:function(e){i.dispatchEvent(new Event("input"))}}))})},i.initChoicePickers=function(){jQuery(".mabel-mc-wrapper").each(function(t,i){new e.Admin.Components.ChoicePicker(jQuery(i))})},i.prototype.initRangeSliders=function(){jQuery('input[type="range"]').each(function(e,t){var i=jQuery(t);i.rangeslider({polyfill:!1,onSlideEnd:function(e,t){i.val(t)}})})},i.prototype.initAccordions=function(){var e=this.parent.find(".mabel-accordion");this.parent.find(".mabel-accordion button.mabel-accordion-btn");e.each(function(e,t){var i=jQuery(t);i.find("button.mabel-accordion-btn").on("click",function(e){e.preventDefault(),jQuery(e.currentTarget).next().toggleClass("mabel-is-expanded").toggleClass("mabel-is-collapsed"),i.toggleClass("active")})})},i.prototype.initEvents=function(){var t=this,i=window.tb_remove;window.tb_remove=function(){i(),e.Admin.Dispatcher.publish("modal:closed")},e.Admin.Dispatcher.subscribe("settings:save",function(){t.saveSettings()})},i.setColorPickerColor=function(e,t){jQuery(".color-picker[name="+e+"]").wpColorPicker("color",t)},i.prototype.initColorPickers=function(){var t=this;this.parent.find(".color-picker").each(function(i,n){function a(i,n){var a=jQuery(i.target),r=a.attr("name");e.Admin.Dispatcher.publish("color:changed",{color:n.color.toString(),id:r}),a.parents(".skip-save").length||(t.saveSettings(),e.Admin.Dispatcher.publish("settings:changed",e.Admin.Helpers.Context.getSettings()))}var r=jQuery(n);if(r.wpColorPicker({defaultColor:r.val(),change:function(e,t){a(e,t)},clear:function(){a({target:r[0]},{color:""})}}),r.val().length){var s={target:n},o={color:r.val()};setTimeout(function(){a(s,o)},30)}})},i.prototype.initChangeSettings=function(){var i=this;this.form.find(".mabel-form-element").on("change",function(n){var a=jQuery(n.currentTarget);a.hasClass("skip-save")||a.parents(".skip-save").length||(t.Dispatcher.publish("settings:changed",e.Admin.Helpers.Context.getSettings()),i.saveSettings())}),this.form.find('input[type="number"]').not(".skip-save").each(function(e,t){var n=jQuery(t);if(!n.parents(".skip-save").length){var a=0;n.on("change keyup keydown input",function(){clearTimeout(a),a=setTimeout(function(){i.saveSettings()},600)})}})},i.prototype.saveSettings=function(){var t=this;this.parent.find(".all-settings-saved").hide(),this.parent.find(".saving-settings").show();var i=this.form.serializeArray();jQuery.post("options.php",i).done(function(){t.parent.find(".all-settings-saved").show(),t.parent.find(".saving-settings").hide(),e.Admin.Dispatcher.publish("settings:saved",e.Admin.Helpers.Context.getSettings())})},i.prototype.initDependencies=function(){var e=this;this.parent.find("[data-dependency]").each(function(t,i){var n=jQuery(i);n.data("dependency").forEach(function(t){var i=e.parent.find('[name="'+e.settingsKey+"["+t.element_id+']"],[name="'+t.element_id+'"]').not(".skip-dependency");i.length&&(i.on("change",function(){var e=i.val(),a=!1;if(i.is(":checkbox")){var r=i.is(":checked");e==t.value&&r&&(a=!0)}else e==t.value&&(a=!0);a?n.closest("tr").show():n.closest("tr").hide()}),i.trigger("change"))})})},i.prototype.initTabs=function(){var t=this,i=this.parent.find(".mabel-nav-tab-wrapper a");this.parent.find(".mabel-tab");i.on("click",function(e){e.preventDefault(),t.setTab(jQuery(e.currentTarget).data("tab"))}),e.Admin.Dispatcher.subscribe("tab:activate",function(e){t.setTab(e)})},i.prototype.setTab=function(t){var i=this.parent.find('[data-tab="'+t+'"]');this.navlinks.removeClass("mabel-nav-tab-active"),i.addClass("mabel-nav-tab-active"),this.tabs.hide(),this.parent.find(".tab-"+t).show(),e.Admin.Dispatcher.publish("tab:changed",t),this.currentTab=t,this.toggleSidebars()},i.prototype.toggleSidebars=function(){this.sidebars.hide();var e=this.sidebars.filter('[data-sidebar-for="'+this.currentTab+'"]');e.length&&!e.is(":empty")?e.show():this.mainSidebar.show()},i}();t.Main=i}(e.Admin||(e.Admin={}))}(Core||(Core={}));
var Core;!function(t){!function(t){var i=function(){function t(){}return t.addFilter=function(t,i){this.filters[t]?this.filters[t].push(i):this.filters[t]=[i]},t.hasFilter=function(t){return!!this.filters[t]},t.applyFilter=function(i,s){if(!t.hasFilter(i))return s;var r=s;return this.filters[i].forEach(function(t){r=t(r)}),r},t.subscribe=function(t,i){this.hOP.call(this.topics,t)||(this.topics[t]=[]);var s=this.topics[t].push(i)-1;return{remove:function(){delete this.topics[t][s]}}},t.publish=function(t,i){this.hOP.call(this.topics,t)&&this.topics[t].forEach(function(t){t(void 0!=i?i:{})})},t.topics=[],t.hOP=[].hasOwnProperty,t.filters=[],t}();t.Dispatcher=i}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(t){!function(t){!function(t){var e=function(){function t(t){this.wrapper=t,this.input=t.find("input[type=hidden]"),this.infotext=t.find(".mabel-mc-chosen em"),this.init()}return t.prototype.init=function(){this.values=this.input.val().split(";"),this.wrapper.find(".mabel-mc-option").css("opacity",1),this.setSelectedValues(),this.initAddToValues(),this.initRemoveFromValues()},t.prototype.setSelectedValues=function(){var t=this;this.wrapper.find(".mabel-mc-choice").remove(),this.wrapper.find(".mabel-mc-option").each(function(e,i){var n=jQuery(i);jQuery.inArray(n.data("id").toString(),t.values)>-1&&(n.css("opacity",.6),t.createChosenOption(n.data("id"),n.html()),t.infotext.hide())})},t.prototype.initAddToValues=function(){var t=this;this.wrapper.find(".mabel-mc-option").off("click").on("click",function(e){e.preventDefault();var i=jQuery(e.currentTarget),n=i.data("id").toString();if(!(jQuery.inArray(n,t.values)>-1)){var a=i.html();t.values.push(n),t.input.val(t.values.join(";")),t.infotext.hide(),i.css("opacity",.6),t.createChosenOption(n,a),t.input[0].dispatchEvent(new Event("input"))}})},t.prototype.initRemoveFromValues=function(){var t=this;this.wrapper.off("click",".mabel-mc-choice"),this.wrapper.on("click",".mabel-mc-choice",function(e){e.preventDefault();var i=jQuery(e.currentTarget),n=i.data("id").toString();t.wrapper.find(".mabel-mc-option[data-id="+n+"]").css("opacity",1),i.remove(),t.values.splice(t.values.indexOf(n),1),t.values.length||t.infotext.show(),t.input.val(t.values.join(";")),t.input[0].dispatchEvent(new Event("input"))})},t.prototype.createChosenOption=function(t,e){this.wrapper.find(".mabel-mc-chosen").append('<span class="mabel-mc-choice" data-id="'+t+'">'+e+' <span class="mabel-mc-close">&times;</span></span>')},t}();t.ChoicePicker=e}(t.Components||(t.Components={}))}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(e){!function(e){!function(e){var t=function(){function e(e,t,i){var n=this;this.hasSelected=!1,this.parent=e,this.preview=e.find(".mabel-media-preview"),this.clearBtn=e.find(".mabel-btn-remove-media"),this.selectBtn=e.find(".mabel-btn-add-media"),this.onSelect=t,this.initMediaSelector(),this.selectBtn.on("click",function(e){e.preventDefault(),n.mediaSelector.open()}),this.clearBtn.on("click",function(e){e.preventDefault(),n.preview.hide().find("img").attr("src",""),i(),n.clearBtn.hide(),n.selectBtn.show()})}return e.prototype.setImageByUrl=function(e){this.preview.find("img").attr("src",e),this.preview.show(),this.selectBtn.hide(),this.clearBtn.show(),this.hasSelected=!0},e.prototype.removeImage=function(){this.clearBtn.hide(),this.selectBtn.show(),this.preview.hide().find("img").attr("src",""),this.hasSelected=!1},e.prototype.initMediaSelector=function(){var e=this;this.mediaSelector=window.wp.media.frames.file_frame=window.wp.media({multiple:!1,title:"Choose or upload an image",button:{text:"Use this image"}}),this.mediaSelector.on("select",function(){e.hasSelected=!0;var t=e.mediaSelector.state().get("selection").first().toJSON();e.preview.find("img").attr("src",t.sizes.thumbnail?t.sizes.thumbnail.url:t.sizes.full.url),e.preview.show(),e.selectBtn.hide(),e.clearBtn.show(),e.onSelect(t)})},e}();e.MediaSelector=t}(e.Components||(e.Components={}))}(e.Admin||(e.Admin={}))}(Core||(Core={}));
var Core;!function(e){!function(e){!function(t){var n=function(){function t(t,n){var l=this;void 0===n&&(n=null),this.$input=t.find("input[type=text]"),this.$parent=t,this.$hidden=t.find("input[type=hidden]"),this.values=t.data("values")?t.data("values"):[],this.onChange=n,this.$input.on("keydown",function(){l.$input.css("width",50+8*l.$input.val().length)}),t.on("click",function(e){e.preventDefault(),l.$input.focus()}),t.mabelAutocomplete(e.Helpers.Context.getAdminAjaxUrl()+"?action="+t.data("action"),{multiple:!0,multipleSep:";",delay:350,onSelect:function(e){l.values.push(e),l.$input.val(""),l.setHiddenValue(),l.addElementsToUi(e),"function"==typeof n&&n(l.$hidden.val())}})}return t.prototype.setValues=function(e){var t=this;this.values=e,this.setHiddenValue(),this.values.forEach(function(e){t.addElementsToUi(e)})},t.prototype.clear=function(){this.values=[],this.$hidden.val(""),this.$parent.find(".mabel-autoselect-chosen").remove()},t.prototype.addElementsToUi=function(e){var t=this;jQuery('<span class="mabel-autoselect-chosen"></span>').html(e.title).on("click",function(n){n.preventDefault(),jQuery(n.currentTarget).remove(),t.values.forEach(function(n,l){n.title===e.title&&t.values.splice(l,1)}),t.setHiddenValue(),"function"==typeof t.onChange&&t.onChange(t.$hidden.val())}).insertBefore(this.$input)},t.prototype.setHiddenValue=function(){var e=[];this.values.forEach(function(t){e.push(t.id)}),this.$hidden.val(e.join(","))},t}();t.MultiAutoComplete=n}(e.Components||(e.Components={}))}(e.Admin||(e.Admin={}))}(Core||(Core={})),function(e){e.mabelautocomplete=function(t,n){function l(){var e=m.offset();v.css({top:e.top+m.outerHeight()+"px",left:e.left+"px"})}function i(e){if(/27$|38$|40$/.test(e.keyCode)&&v.is(":visible")||/^13$|^9$/.test(e.keyCode)&&r())switch(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,e.keyCode){case 38:h();break;case 40:p();break;case 9:case 13:d();break;case 27:v.hide()}else m.val().length!=g&&(C&&clearTimeout(C),C=setTimeout(s,n.delay),g=m.val().length)}function s(){var t,l,i=e.trim(m.val());if(n.multiple&&-1!=(t=i.lastIndexOf(n.multipleSep))&&(i=e.trim(i.substr(t+n.multipleSep.length))),i.length>=n.minchars){var s=a(i);s?u(s.items):(f.addClass("mabel-autocomplete-loading"),e.getJSON(n.source,{q:i},function(e){v.hide(),l=[],console.log(e);for(var t=0;t<e.length;t++)l.push(c(e[t],i));u(l),o(i,l),f.removeClass("mabel-autocomplete-loading")}))}else v.hide()}function a(e){var t;for(t=0;t<y.length;t++)if(y[t].q==e)return y.unshift(y.splice(t,1)[0]),y[0];return!1}function o(e,t){y.push({q:e,items:t})}function u(t){var i,s="";if(t){if(!t.length)return void v.hide();for(l(),i=0;i<t.length;i++)s+="<li>"+t[i]+"</li>";v.html(s).show(),v.children("li").mouseover(function(){v.children("li").removeClass(n.selectClass),e(this).addClass(n.selectClass)}).click(function(e){e.preventDefault(),e.stopPropagation(),d()})}}function c(e,t){return'<span data-id="'+e.id+'">'+e.title+"</span>"}function r(){var e;return!!v.is(":visible")&&(e=v.children("li."+n.selectClass),e.length||(e=!1),e)}function d(){var e=r();if(e){var t=e.text(),l=e.find("span").first().data("id");n.onSelect&&n.onSelect({title:t,id:l})}}function p(){var e=r();e?e.removeClass(n.selectClass).next().addClass(n.selectClass):v.children("li:first-child").addClass(n.selectClass)}function h(){var e=r();e?e.removeClass(n.selectClass).prev().addClass(n.selectClass):v.children("li:last-child").addClass(n.selectClass)}var f,m,v,C,g,y;f=e(t),m=f.find("input[type=text]").attr("autocomplete","off"),v=e('<ul class="mabel-autocomplete-results"/>'),C=!1,g=0,y=[],v.addClass(n.resultsClass).appendTo("body"),l(),e(window).on("load",l).on("resize",l),m.blur(function(){setTimeout(function(){v.hide()},200)}),m.keydown(i)},e.fn.mabelAutocomplete=function(t,n){if(t)return n=n||{},n.multiple=n.multiple||!1,n.multipleSep=n.multipleSep||",",n.source=t,n.delay=n.delay||100,n.resultsClass=n.resultsClass||"ac_results",n.selectClass=n.selectClass||"ac_over",n.matchClass=n.matchClass||"ac_match",n.minchars=n.minchars||2,n.delimiter=n.delimiter||"\n",n.onSelect=n.onSelect||!1,n.maxCacheSize=n.maxCacheSize||65536,this.each(function(){new e.mabelautocomplete(this,n)}),this}}(jQuery);
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";function i(t,i){var e=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},i)}function e(t,i){return i=i||100,function(){if(!t.debouncing){var e=Array.prototype.slice.apply(arguments);t.lastReturnVal=t.apply(window,e),t.debouncing=!0}return clearTimeout(t.debounceTimeout),t.debounceTimeout=setTimeout(function(){t.debouncing=!1},i),t.lastReturnVal}}function n(t){return t&&(0===t.offsetWidth||0===t.offsetHeight||!1===t.open)}function s(t){for(var i=[],e=t.parentNode;n(e);)i.push(e),e=e.parentNode;return i}function o(t,i){function e(t){void 0!==t.open&&(t.open=!t.open)}var n=s(t),o=n.length,r=[],h=t[i];if(o){for(var a=0;a<o;a++)r[a]=n[a].style.cssText,n[a].style.setProperty?n[a].style.setProperty("display","block","important"):n[a].style.cssText+=";display: block !important",n[a].style.height="0",n[a].style.overflow="hidden",n[a].style.visibility="hidden",e(n[a]);h=t[i];for(var l=0;l<o;l++)n[l].style.cssText=r[l],e(n[l])}return h}function r(t,i){var e=parseFloat(t);return Number.isNaN(e)?i:e}function h(t){return t.charAt(0).toUpperCase()+t.substr(1)}function a(n,s){if(this.$window=t(window),this.$document=t(document),this.$element=t(n),this.options=t.extend({},p,s),this.polyfill=this.options.polyfill,this.orientation=this.$element[0].getAttribute("data-orientation")||this.options.orientation,this.onInit=this.options.onInit,this.onSlide=this.options.onSlide,this.onSlideEnd=this.options.onSlideEnd,this.DIMENSION=f.orientation[this.orientation].dimension,this.DIRECTION=f.orientation[this.orientation].direction,this.DIRECTION_STYLE=f.orientation[this.orientation].directionStyle,this.COORDINATE=f.orientation[this.orientation].coordinate,this.polyfill&&u)return!1;this.identifier="js-"+l+"-"+d++,this.startEvent=this.options.startEvent.join("."+this.identifier+" ")+"."+this.identifier,this.moveEvent=this.options.moveEvent.join("."+this.identifier+" ")+"."+this.identifier,this.endEvent=this.options.endEvent.join("."+this.identifier+" ")+"."+this.identifier,this.toFixed=(this.step+"").replace(".","").length-1,this.$fill=t('<div class="'+this.options.fillClass+'" />'),this.$handle=t('<div class="'+this.options.handleClass+'" />'),this.$range=t('<div class="'+this.options.rangeClass+" "+this.options[this.orientation+"Class"]+'" id="'+this.identifier+'" />').insertAfter(this.$element).prepend(this.$fill,this.$handle),this.$element.css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"}),this.handleDown=t.proxy(this.handleDown,this),this.handleMove=t.proxy(this.handleMove,this),this.handleEnd=t.proxy(this.handleEnd,this),this.init();var o=this;this.$window.on("resize."+this.identifier,e(function(){i(function(){o.update(!1,!1)},300)},20)),this.$document.on(this.startEvent,"#"+this.identifier+":not(."+this.options.disabledClass+")",this.handleDown),this.$element.on("change."+this.identifier,function(t,i){if(!i||i.origin!==o.identifier){var e=t.target.value,n=o.getPositionFromValue(e);o.setPosition(n)}})}Number.isNaN=Number.isNaN||function(t){return"number"==typeof t&&t!==t};var l="rangeslider",d=0,u=function(){var t=document.createElement("input");return t.setAttribute("type","range"),"text"!==t.type}(),p={polyfill:!0,orientation:"horizontal",rangeClass:"rangeslider",disabledClass:"rangeslider--disabled",activeClass:"rangeslider--active",horizontalClass:"rangeslider--horizontal",verticalClass:"rangeslider--vertical",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"]},f={orientation:{horizontal:{dimension:"width",direction:"left",directionStyle:"left",coordinate:"x"},vertical:{dimension:"height",direction:"top",directionStyle:"bottom",coordinate:"y"}}};a.prototype.init=function(){this.update(!0,!1),this.onInit&&"function"==typeof this.onInit&&this.onInit()},a.prototype.update=function(t,i){t=t||!1,t&&(this.min=r(this.$element[0].getAttribute("min"),0),this.max=r(this.$element[0].getAttribute("max"),100),this.value=r(this.$element[0].value,Math.round(this.min+(this.max-this.min)/2)),this.step=r(this.$element[0].getAttribute("step"),1)),this.handleDimension=o(this.$handle[0],"offset"+h(this.DIMENSION)),this.rangeDimension=o(this.$range[0],"offset"+h(this.DIMENSION)),this.maxHandlePos=this.rangeDimension-this.handleDimension,this.grabPos=this.handleDimension/2,this.position=this.getPositionFromValue(this.value),this.$element[0].disabled?this.$range.addClass(this.options.disabledClass):this.$range.removeClass(this.options.disabledClass),this.setPosition(this.position,i)},a.prototype.handleDown=function(t){if(t.preventDefault(),this.$document.on(this.moveEvent,this.handleMove),this.$document.on(this.endEvent,this.handleEnd),this.$range.addClass(this.options.activeClass),!((" "+t.target.className+" ").replace(/[\n\t]/g," ").indexOf(this.options.handleClass)>-1)){var i=this.getRelativePosition(t),e=this.$range[0].getBoundingClientRect()[this.DIRECTION],n=this.getPositionFromNode(this.$handle[0])-e,s="vertical"===this.orientation?this.maxHandlePos-(i-this.grabPos):i-this.grabPos;this.setPosition(s),i>=n&&i<n+this.handleDimension&&(this.grabPos=i-n)}},a.prototype.handleMove=function(t){t.preventDefault();var i=this.getRelativePosition(t),e="vertical"===this.orientation?this.maxHandlePos-(i-this.grabPos):i-this.grabPos;this.setPosition(e)},a.prototype.handleEnd=function(t){t.preventDefault(),this.$document.off(this.moveEvent,this.handleMove),this.$document.off(this.endEvent,this.handleEnd),this.$range.removeClass(this.options.activeClass),this.$element.trigger("change",{origin:this.identifier}),this.onSlideEnd&&"function"==typeof this.onSlideEnd&&this.onSlideEnd(this.position,this.value)},a.prototype.cap=function(t,i,e){return t<i?i:t>e?e:t},a.prototype.setPosition=function(t,i){var e,n;void 0===i&&(i=!0),e=this.getValueFromPosition(this.cap(t,0,this.maxHandlePos)),n=this.getPositionFromValue(e),this.$fill[0].style[this.DIMENSION]=n+this.grabPos+"px",this.$handle[0].style[this.DIRECTION_STYLE]=n+"px",this.setValue(e),this.position=n,this.value=e,i&&this.onSlide&&"function"==typeof this.onSlide&&this.onSlide(n,e)},a.prototype.getPositionFromNode=function(t){for(var i=0;null!==t;)i+=t.offsetLeft,t=t.offsetParent;return i},a.prototype.getRelativePosition=function(t){var i=h(this.COORDINATE),e=this.$range[0].getBoundingClientRect()[this.DIRECTION],n=0;return void 0!==t.originalEvent["client"+i]?n=t.originalEvent["client"+i]:t.originalEvent.touches&&t.originalEvent.touches[0]&&void 0!==t.originalEvent.touches[0]["client"+i]?n=t.originalEvent.touches[0]["client"+i]:t.currentPoint&&void 0!==t.currentPoint[this.COORDINATE]&&(n=t.currentPoint[this.COORDINATE]),n-e},a.prototype.getPositionFromValue=function(t){var i;return i=(t-this.min)/(this.max-this.min),Number.isNaN(i)?0:i*this.maxHandlePos},a.prototype.getValueFromPosition=function(t){var i,e;return i=t/(this.maxHandlePos||1),e=this.step*Math.round(i*(this.max-this.min)/this.step)+this.min,Number(e.toFixed(this.toFixed))},a.prototype.setValue=function(t){t===this.value&&""!==this.$element[0].value||this.$element.val(t).trigger("input",{origin:this.identifier})},a.prototype.destroy=function(){this.$document.off("."+this.identifier),this.$window.off("."+this.identifier),this.$element.off("."+this.identifier).removeAttr("style").removeData("plugin_"+l),this.$range&&this.$range.length&&this.$range[0].parentNode.removeChild(this.$range[0])},t.fn[l]=function(i){var e=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=t(this),s=n.data("plugin_"+l);s||n.data("plugin_"+l,s=new a(this,i)),"string"==typeof i&&s[i].apply(s,e)})}});
var Core;!function(t){!function(t){!function(t){var e=function(){function t(t){var e=this;this.stepContents=t.find("[data-step]"),this.steps=t.find(".step"),this.currentStep=1,t.find(".mabel-btn-next-step").off("click").on("click",function(t){t.preventDefault(),e.next()}),t.find(".mabel-btn-prev-step").off("click").on("click",function(t){t.preventDefault(),e.prev()}),this.steps.on("click",function(t){var s=jQuery(t.currentTarget);(s.hasClass("done")||s.hasClass("current"))&&e.setStep(e.steps.index(s)+1)})}return t.prototype.toggleClasses=function(){this.stepContents.hide(),this.stepContents.eq(this.currentStep-1).show(),this.steps.filter(".current").addClass("done").removeClass("current"),this.steps.eq(this.currentStep-1).addClass("current"),jQuery("html,body").scrollTop(0)},t.prototype.jumpToLastStep=function(){this.currentStep=this.steps.length,this.toggleClasses(),this.steps.addClass("done")},t.prototype.reset=function(){this.steps.removeClass("done"),this.currentStep=1,this.toggleClasses()},t.prototype.setStep=function(t){this.currentStep=t,this.toggleClasses()},t.prototype.next=function(){this.currentStep++,this.toggleClasses(),this.steps.eq(this.currentStep-1).is(":hidden")&&this.next()},t.prototype.prev=function(){this.currentStep--,this.toggleClasses(),this.steps.eq(this.currentStep-1).is(":hidden")&&this.prev()},t}();t.StepTracker=e}(t.Components||(t.Components={}))}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(t){!function(t){!function(t){var e=function(){function t(){}return t.getSlug=function(){return jQuery("[data-context]").data("slug")},t.getBaseUrl=function(){return jQuery("[data-context]").data("base-url")},t.getSettings=function(){var e=jQuery("#"+t.getSlug()+"-form").serializeArray(),n={};return e.forEach(function(e,a){var r=e.name.replace(t.getSettingsKey()+"[","").replace("]","");n[r]=e.value}),n},t.getSettingsKey=function(){return jQuery("[data-context]").data("settings-key")},t.getAdminAjaxUrl=function(){return jQuery("[data-context]").data("admin-ajax-url")},t.isActivated=function(){return 1==jQuery("[data-context]").data("activated")},t}();t.Context=e}(t.Helpers||(t.Helpers={}))}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(e){!function(e){!function(e){var n=function(){function e(){}return e.initDependencies=function(e){var n=this;jQuery("[data-dependency]").each(function(e,t){for(var i=jQuery(t).data("dependency"),r=0;r<i.length;r++){var a=i[r],l=[];i.forEach(function(e){e.element_id!==a.element_id&&l.push(e)});var u=n.findDependencyById(a.element_id);if(null===u){var o={show_element:jQuery(t).attr("name"),values:a.values,also:l};n.dependencies.push({id:a.element_id,values:[o]})}else u.values.push({values:a.values,show_element:jQuery(t).attr("name"),also:l})}}),this.dependencies.forEach(function(t){var i=jQuery('[name="'+e+"["+t.id+']"],[name="'+t.id+'"]').not(".skip-dependency");i.on("change",function(r){var a=n.getValueFromElement(i);n.hideAllElementsInDependency(e,t),n.findElementsWithValue(i,t.values,a,e).forEach(function(e){jQuery('[name="'+e+'"]').closest("tr").show()})}),i.trigger("change")})},e.getValueFromElement=function(e){var n=e.val();return e.is(":checkbox")&&(n=e.is(":checked")),e.is(":radio")&&(n=e.filter(":checked").val()),n},e.findElementsWithValue=function(e,n,t,i){var r=this,a=[];return n.forEach(function(n){var l=!0;n.also.length&&n.also.forEach(function(e){var n=jQuery('[name="'+i+"["+e.element_id+']"],[name="'+e.element_id+'"]').not(".skip-dependency"),t=r.getValueFromElement(n);null!==t&&-1===jQuery.inArray(t.toString(),e.values)&&(l=!1)}),l&&null!=t&&""!=t.toString()&&("choice"===e.data("option-type")&&t.split(";").some(function(e){return n.values.indexOf(e)>=0})?a.push(n.show_element):jQuery.inArray(t.toString(),n.values)>=0&&a.push(n.show_element))}),a},e.hideAllElementsInDependency=function(e,n){n.values.forEach(function(e){jQuery('[name="'+e.show_element+'"]').closest("tr").hide()})},e.findDependencyById=function(e){for(var n=0;n<this.dependencies.length;n++){var t=this.dependencies[n];if(t.id===e)return t}return null},e.dependencies=[],e}();e.Dependencies=n}(e.Helpers||(e.Helpers={}))}(e.Admin||(e.Admin={}))}(Core||(Core={}));
var WOFAdmin;!function(e){var i=function(){function i(){Core.Admin.Main.loading(),this.$listSettingsWrapper=jQuery(".list-setting-wrapper"),this.$listProviderDropdown=jQuery("select[name=list_provider]"),this.$listDropdown=jQuery("select[name=list_list]"),this.$formBuilderForLists=jQuery(".form-builder-for-lists"),this.$formBuilderForOther=jQuery(".form-builder-for-other"),this.$mailchimpListSettingsWrapper=jQuery("[name=mailchimp_list_settings]").closest("tr").hide(),this.$toolsInfoBubbles=jQuery("[class*=info-bubble-tool-]"),this.$enableWooCouponsSetting=jQuery('[name="mb-wof-settings[woo_coupons]"]'),this.$enablePrizeLimit=jQuery("[name=limit_prizes]"),this.$form=jQuery("#"+Core.Admin.Helpers.Context.getSlug()+"-form"),e.Helpers.Cache.providers=jQuery("[data-integrations]").data("integrations"),e.Helpers.Cache.providers=Core.Admin.Dispatcher.applyFilter("wof-add-provider",e.Helpers.Cache.providers),this.formBuilderForOthers=new e.Components.FormBuilderOthers(jQuery("div.form-builder-for-other")),this.formBuilderForLists=new e.Components.FormBuilderLists(jQuery("div.form-builder-for-lists")),this.designCtrl=new e.Controllers.Design,this.wheelCtrl=new e.Controllers.CreateWheelCtrl(this.formBuilderForLists,this.formBuilderForOthers),this.GdprCtr=new e.Controllers.Gdpr,this.wheelsListCtrl=new e.Controllers.WheelsListCtrl,this.integrationsCtrl=new e.Controllers.Integrations,this.currentProvider=e.Helpers.Cache.providers[0],this.wheelCtrl.model.list_provider=this.currentProvider.id,this.wheelCtrl.model.list=null,this.wheelCtrl.model.name=jQuery("[data-key=name]").val();var i=Core.Admin.Helpers.Context.getSettings();this.initEvents(),this.postSettingsChangedEvents(i),this.initSetEditMode(),this.setLists(),this.designCtrl.updatePreview(this.wheelCtrl.model);var t=jQuery("[data-id=show_on_pages]");t.find("input[type=hidden]").val("-1"),this.wheelCtrl.model.show_on_pages="-1",new Core.Admin.Components.ChoicePicker(t),"none"===this.wheelCtrl.model.list_provider&&this.toggleEmailSettings("hide")}return i.prototype.toggleEmailSettings=function(e){void 0===e&&(e="show");var i=jQuery("#ckb-send_emails"),t=jQuery("#ckb-send_lost_email");"hide"===e&&(i.prop("checked",!1).trigger("change"),t.prop("checked",!1).trigger("change")),t.closest("tr")[e](),i.closest("tr")[e]()},i.prototype.setLists=function(i,t,r){var o=this;void 0===i&&(i="all"),void 0===t&&(t=!1),void 0===r&&(r=null);var l=function(){o.setProviderDropdownOptions(),o.currentProvider.isListProvider&&o.setListDropdownOptions(),o.wheelCtrl.model.use_mailchimp_group&&"mailchimp"===o.wheelCtrl.model.list_provider&&o.loadMailchimpGroups(),t||Core.Admin.Main.loading(),"function"==typeof r&&r()};if("all"===i)e.Api.Mail.getActiveProvidersLists().then(function(i){for(var t=0;t<i.length;t++){e.helpers.Collections.findBy(e.Helpers.Cache.providers,"id",i[t].id).lists=i[t].lists}l()});else{var s=e.helpers.Collections.findBy(e.Helpers.Cache.providers,"id",i);s.showListSetting?e.Api.Mail.getProviderLists(i).then(function(e){s.lists=e,l()}):l()}},i.prototype.setListDropdownOptions=function(){var i=this,t=e.helpers.Collections.findBy(e.Helpers.Cache.providers,"id",this.currentProvider.id);null!==t&&(this.$listDropdown.empty(),t.lists.forEach(function(e){jQuery("<option />",{val:e.id,text:e.title}).appendTo(i.$listDropdown)}),this.wheelCtrl.model.list?this.$listDropdown.val(this.wheelCtrl.model.list):this.wheelCtrl.model.list=this.$listDropdown.val(),this.formBuilderForLists.getFieldsFromList(this.wheelCtrl.model.list_provider,this.wheelCtrl.model.list))},i.prototype.setProviderDropdownOptions=function(){var i=this;this.$listProviderDropdown.empty(),e.Helpers.Cache.providers.forEach(function(e){if(e.installed){jQuery("<option />",{val:e.id,text:e.title}).appendTo(i.$listProviderDropdown)}}),this.$listProviderDropdown.val(this.wheelCtrl.model.list_provider)},i.prototype.initEvents=function(){var i=this;Core.Admin.Dispatcher.subscribe("customBg:changed",function(e){jQuery.isEmptyObject(e)?i.wheelCtrl.model.custom_bg=null:i.wheelCtrl.model.custom_bg=e.sizes.full.url}),Core.Admin.Dispatcher.subscribe("logo:changed",function(e){jQuery.isEmptyObject(e)?i.wheelCtrl.model.logo=null:i.wheelCtrl.model.logo=e.sizes.full.url}),Core.Admin.Dispatcher.subscribe("wof-wheel:created",function(){i.wheelsListCtrl.getWheelsList()}),Core.Admin.Dispatcher.subscribe("settings:changed",function(t){i.postSettingsChangedEvents(t);for(var r=0;r<e.Helpers.Cache.providers.length;r++){var o=e.Helpers.Cache.providers[r];if(!o.installed&&!o.lists&&void 0!==o.keys){for(var l=!0,s=0;s<o.keys.length;s++)if(!t[o.keys[s]]){l=!1;break}l&&jQuery('.integration-tile[data-id="'+o.id+'"] .tag-id').html("Active").show()}}}),Core.Admin.Dispatcher.subscribe("settings:saved",function(t){for(var r=0;r<e.Helpers.Cache.providers.length;r++){var o=e.Helpers.Cache.providers[r];if(!o.installed&&!o.lists&&void 0!==o.keys){for(var l=!0,s=0;s<o.keys.length;s++)if(!t[o.keys[s]]){l=!1;break}l&&(o.installed=!0,i.setLists(o.id,!0,function(){jQuery('.integration-tile[data-id="'+o.id+'"] .tag-id').html("Active")}))}}}),this.$enableWooCouponsSetting.on("change",function(e){jQuery("[name=wof-slice-type]").trigger("change")}),this.$enablePrizeLimit.on("change",function(e){jQuery(e.currentTarget).is(":checked")?jQuery(".wof-td-limit").show():jQuery(".wof-td-limit").hide()}),this.$enablePrizeLimit.trigger("change"),this.$listProviderDropdown.on("change",function(t){var r=i.$listProviderDropdown.val();i.currentProvider=e.helpers.Collections.findBy(e.Helpers.Cache.providers,"id",r),i.wheelCtrl.model.list_provider=r,i.$toolsInfoBubbles.hide(),i.$toolsInfoBubbles.filter(".info-bubble-tool-"+r).show(),i.currentProvider.isListProvider?(i.setListDropdownOptions(),i.$formBuilderForLists.show(),i.$formBuilderForOther.hide()):(i.$formBuilderForLists.hide(),i.$formBuilderForOther.show()),i.currentProvider.hideFormBuilder?(jQuery("li.form-builder-step-tab").hide(),jQuery("ul.step-tracker").removeClass("steps-5").addClass("steps-4")):(jQuery("li.form-builder-step-tab").show(),jQuery("ul.step-tracker").removeClass("steps-4").addClass("steps-5")),i.currentProvider.needsEmail?(i.toggleEmailSettings("show"),jQuery("[name=check_mail_domains]").closest("tr").show()):(jQuery("[name=check_mail_domains]").closest("tr").hide(),i.toggleEmailSettings("hide"),i.wheelCtrl.model.send_emails=!1),"mailchimp"===i.currentProvider.id?i.$mailchimpListSettingsWrapper.show():i.$mailchimpListSettingsWrapper.hide(),i.toggleFacebookSettings(),i.currentProvider.showListSetting?i.$listSettingsWrapper.show():i.$listSettingsWrapper.hide(),Core.Admin.Dispatcher.publish("provider:changed",{provider:r})}),this.$listDropdown.on("change",function(e){var t=jQuery(e.currentTarget).val();i.wheelCtrl.model.list=t,null!=i.currentProvider&&i.currentProvider.isListProvider&&i.formBuilderForLists.getFieldsFromList(i.wheelCtrl.model.list_provider,t),"mailchimp"===i.wheelCtrl.model.list_provider&&i.wheelCtrl.model.use_mailchimp_group&&i.loadMailchimpGroups()}),jQuery("input[name=use_mailchimp_group]").on("change",function(e){jQuery(e.currentTarget).is(":checked")&&i.loadMailchimpGroups()}),jQuery("[name=appeartype]").on("change",function(e){"click"===jQuery(e.currentTarget).val()?jQuery("[name=occurance_after]").closest("tr").hide():jQuery("[name=retries]").is(":checked")&&jQuery("[name=occurance_after]").closest("tr").show()})},i.prototype.toggleFacebookSettings=function(){var i=jQuery("[name=enable_fb]");if(i.closest("tr").hide(),jQuery("[name=fb_obligated]").closest("tr").hide(),"none"!==this.wheelCtrl.model.list_provider){"chatfuel"===this.wheelCtrl.model.list_provider&&(i.prop("checked",!0),this.wheelCtrl.model.enable_fb=!0);var t=e.helpers.Collections.findBy(e.Helpers.Cache.providers,"id","chatfuel");(null!=t&&t.installed||"chatfuel"===this.wheelCtrl.model.list_provider)&&(i.closest("tr").show(),i.trigger("change"))}},i.prototype.loadMailchimpGroups=function(){var i=this,t=jQuery("select[name=mailchimp_group]").empty();jQuery("<option>Loading...</option>").appendTo(t),e.Api.Mail.getMailchimpGroups(this.$listDropdown.val()).then(function(e){t.empty(),e.forEach(function(e){jQuery("<option />",{val:e.id,text:e.title}).appendTo(t)}),i.wheelCtrl.model.mailchimp_group?t.val(i.wheelCtrl.model.mailchimp_group):i.wheelCtrl.model.mailchimp_group=t.val()})},i.prototype.postSettingsChangedEvents=function(e){void 0===e&&(e=null),e=e||Core.Admin.Helpers.Context.getSettings(),"true"==e.woo_coupons?jQuery('.mabel-accordion[name="coupon_bar_settings"]').show():(jQuery('.mabel-accordion[name="coupon_bar_settings"]').hide(),this.wheelCtrl.model.coupon_bar=!1,this.wheelCtrl.model.woo_auto_apply=!1)},i.prototype.initSetEditMode=function(){var i=this;Core.Admin.Dispatcher.subscribe("wof-wheel:edit",function(t){i.wheelCtrl.setEditMode(),i.wheelCtrl.resetStepTracker(t),Core.Admin.Dispatcher.publish("tab:activate","options-addwheel"),i.currentProvider=e.helpers.Collections.findBy(e.Helpers.Cache.providers,"id",i.wheelCtrl.model.list_provider),i.currentProvider.isListProvider?i.formBuilderForLists.setFields(i.wheelCtrl.model.fields):i.formBuilderForOthers.setFields(i.wheelCtrl.model.fields),i.$listProviderDropdown.val(i.wheelCtrl.model.list_provider),i.$listDropdown.val(i.wheelCtrl.model.list),i.$listProviderDropdown.trigger("change"),i.$enablePrizeLimit.trigger("change"),jQuery("#ckb-check_mail_domains,#ckb-use_mailchimp_group,#ckb-send_emails,#ckb-send_lost_email,#ckb-retries,#ckb-coupon_bar,#ckb-enable_fb,#ckb-log_ips,#ckb-notify").trigger("change"),i.designCtrl.setDesignSettings(i.wheelCtrl.model.theme),i.designCtrl.updateLogo(i.wheelCtrl.model.logo),i.designCtrl.updateCustomBg(i.wheelCtrl.model.custom_bg);for(var r=[],o=[],l=0;l<i.wheelCtrl.model.amount_of_slices;l++)o.push(i.wheelCtrl.model.slices[l].bg),r.push(i.wheelCtrl.model.slices[l].fg);i.designCtrl.updateSliceColors(o,r),i.designCtrl.updatePreview(i.wheelCtrl.model),i.setTinyMCEEditors(t),Core.Admin.Main.initChoicePickers(),i.GdprCtr.initGdprSettingOptions(i.wheelCtrl.model.fields,i.wheelCtrl.model.optin_if_checked),Core.Admin.Main.loading()})},i.prototype.setTinyMCEEditors=function(e){var i=this.getTinyMCEEditor("explainer");null!==i&&e.explainer&&i.setContent(e.explainer);var i=this.getTinyMCEEditor("disclaimer");null!==i&&e.disclaimer&&i.setContent(e.disclaimer)},i.prototype.getTinyMCEEditor=function(e){if(void 0===window.tinymce)return null;for(var i=0;i<window.tinymce.editors.length;i++){var t=window.tinymce.editors[i];if(t.id===e)return t}return null},i.prototype.getThemePreviewUrl=function(e){return this.designCtrl.getPreviewUrlById(e)},i}();e.Main=i}(WOFAdmin||(WOFAdmin={})),jQuery(document).ready(function(){Core.Admin.Helpers.Context.isActivated()&&(window.WOFAdminMain=new WOFAdmin.Main,window.waitForFinalEvent=function(){})});
var WOFAdmin;!function(t){!function(t){var n=function(){function t(){}return t.deleteOptins=function(n){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.delete_logs,id:n}).then(function(t){return t})},t.getLastOptins=function(n){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_optins,id:n}).then(function(t){return t})},t.get_optins="mb-wof-get-last-optins",t.delete_logs="mb-wof-delete-logs",t}();t.Log=n}(t.Api||(t.Api={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(t){var r=function(){function t(){}return t.getListFields=function(r,n){return void 0===n&&(n=null),jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_list_fields,provider:r,list:n}).fail(function(){Core.Admin.Main.showError("Something went wrong :(","We couldn't fetch form fields for your "+e.helpers.Strings.providerToText(r)+" list. Please check your API credentials in the 'Integrations' tab.<br/><br/>Not the issue? Contact hello@maartenbelmans.com for support.")}).then(function(e){return e})},t.getActiveProvidersLists=function(){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_active_provider_lists}).fail(function(){Core.Admin.Main.showError("Something went wrong :(","One of your wheels is connected to a tool we can't seem to connect to. Please verify your API settings are correct in the 'Integrations' tab.<br/><br/>Not the issue? Contact hello@maartenbelmans.com for support.")}).then(function(e){return e})},t.getProviderLists=function(e){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_provider_lists,provider:e}).fail(function(){Core.Admin.Main.showError("Something went wrong :(","We couldn't fetch the lists for <b>"+e+"</b>. Please verify your settings for "+e+" are correct. You can find them in the 'Integrations' tab.")}).then(function(e){return e})},t.getMailchimpGroups=function(e){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_mailchimp_groups,id:e}).then(function(e){return e})},t.get_provider_lists="mb-wof-get-provider-lists",t.get_active_provider_lists="mb-wof-get-active-provider-lists",t.get_list_fields="mb-wof-get-list-fields",t.get_mailchimp_groups="mb-wof-get-mailchimp-groups",t}();t.Mail=r}(e.Api||(e.Api={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(e){var t=function(){function e(){}return e.toggleActivation=function(t,n){return jQuery.post(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.toggle_active_toggle,id:t,toggle:n}).then(function(e){return e})},e.updateWheel=function(t,n){return jQuery.post(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.update_wheel_action,id:t,options:JSON.stringify(this.removeEmpties(n))}).then(function(e){return e})},e.addWheel=function(t){return jQuery.post(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.add_wheel_action,options:JSON.stringify(this.removeEmpties(t))}).then(function(e){return e})},e.deleteWheel=function(t){return jQuery.get(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.delete_wheel_action,id:t}).then(function(e){return e})},e.getWheels=function(){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.get_wheels_action}).then(function(e){return e})},e.getWheel=function(t){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.get_wheel_action,id:t}).then(function(e){return e})},e.getStatistics=function(){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.get_statistics_action}).then(function(e){return e})},e.removeEmpties=function(e){var t={};return e.active=null,Object.keys(e).forEach(function(n){void 0!==e[n]&&null!==e[n]&&(t[n]=e[n])}),t},e.get_wheel_action="mb-wof-get-wheel",e.get_wheels_action="mb-wof-get-wheels",e.delete_wheel_action="mb-wof-delete-wheel",e.add_wheel_action="mb-wof-add-wheel",e.update_wheel_action="mb-wof-update-wheel",e.toggle_active_toggle="mb-wof-toggle-activation",e.get_statistics_action="mb-wof-get-statistics",e}();e.Wheels=t}(e.Api||(e.Api={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(t){!function(t){var e=function(){function t(){}return t.getProductNames=function(e){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_product_names_by_ids,ids:e}).then(function(t){return t})},t.getProductCategories=function(e){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_product_categories_by_ids,ids:e}).then(function(t){return t})},t.get_product_names_by_ids="mb-wof-get-product-names-by-ids",t.get_product_categories_by_ids="mb-wof-get-product-categories-by-ids",t}();t.WooCommerce=e}(t.Api||(t.Api={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var i=function(){function n(){}return n}();n.WordPress=i}(n.Api||(n.Api={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(i){var t=function(){function i(e){this.fieldsFromListServer=[],this.fieldsFromWheel=[],this.$table=e.find("table.wof-field-builder-table"),this.$loading=e.find(".form-builder-for-lists-loading"),this.initEvents()}return i.prototype.initEvents=function(){var i=this;this.$table.on("change",".field-include",function(e){var t=jQuery(e.currentTarget),r=i.rowToField(t.closest("tr"));Core.Admin.Dispatcher.publish(t.is(":checked")?"field:added":"field:removed",r)}),this.$table.on("change","input[type=text],.field-required",function(t){var r=jQuery(t.currentTarget).closest("tr"),d=e.helpers.Collections.findBy(i.fieldsFromWheel,"id",r.data("field-id"));null!=d&&(d.required=r.find(".field-required").is(":checked"),d.placeholder=r.find("input[type=text]").val())}),jQuery(".btn-wof-add-custom-field").on("click",function(t){t.preventDefault();var r=jQuery("table.wof-custom-field-table"),d=r.find('select[name="wof-form-builder-type"]').val().trim(),l=r.find('input[name="wof-form-builder-placeholder"]').val().trim(),o=r.find('input[name="wof-form-builder-required"]').is(":checked"),n=i.UIToFields(),a={disableRequired:!1,options:{},placeholder:l,required:o,id:e.helpers.Collections.nextAvailableName(d,n),type:d};i.fieldsFromWheel.push(a),Core.Admin.Dispatcher.publish("field:added",a),i.drawTableRows(),window.tb_remove()})},i.prototype.getFieldsFromList=function(i,t){var r=this;this.$loading.show(),this.fieldsFromListServer=[];var d=function(e,i){r.fieldsFromListServer=r.fieldsFromListServer.concat(e),r.$loading.hide(),r.drawTableRows()};e.Api.Mail.getListFields(i,t).then(function(e){d(e)})},i.prototype.drawTableRows=function(){var i=this,t=[];this.fieldsFromWheel.forEach(function(r){if("primary_email"!==r.id){var d=e.helpers.Collections.findBy(i.fieldsFromListServer,"id",r.id),l={placeholder:r.placeholder?r.placeholder:"",checked:!0,id:r.id,required:!!r.required&&r.required,options:d?d.options:r.options,type:r.type,title:d?d.title:e.helpers.Strings.capitalizeWords(r.type.replace("_"," "))};t.push(l)}}),this.fieldsFromListServer.forEach(function(i){if("primary_email"!==i.id&&null==e.helpers.Collections.findBy(t,"id",i.id)){var r={placeholder:"",required:!!i.required&&i.required,checked:!1,title:i.title,id:i.id,type:i.type,options:i.options};t.push(r)}});var r=window.doT.template(jQuery("#tpl-wof-field-builder-lists-row").html());this.$table.find("tbody").html(r({fields:t})),window.Sortable.create(this.$table.find("tbody")[0],{animation:150,handle:".sorting-handle"})},i.prototype.UIToFields=function(){var e=this,i=[];return this.$table.find(".form-field-tr").each(function(t,r){var d=jQuery(r),l=d.find("input[type=text]").val();d.find(".field-include").is(":checked")&&("primary_email"===d.data("field-id")?i.push({placeholder:l,required:!0,id:"primary_email",type:"primary_email"}):i.push(e.rowToField(d)))}),i},i.prototype.rowToField=function(e){var i=(e.find(".field-include").is(":checked"),e.find(".field-required").is(":checked")),t=e.find("input[type=text]").val(),r=e.data("field-type"),d=e.data("field-id"),l=e.data("options");return{placeholder:t,required:i,id:d,type:r,options:l?JSON.parse(unescape(atob(l))):""}},i.prototype.setFields=function(e){this.fieldsFromWheel=e},i}();i.FormBuilderLists=t}(e.Components||(e.Components={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(i){var t=function(){function i(e){this.fields=[],this.$table=e.find("table.wof-field-builder-table"),this.initEvents()}return i.prototype.drawTableRows=function(){var e=window.doT.template(jQuery("#tpl-wof-field-builder-other-row").html()),i=[];this.fields.forEach(function(e){"primary_email"!==e.type&&i.push(e)}),this.$table.find("tbody").html(e({fields:i})),window.Sortable.create(this.$table.find("tbody")[0],{animation:150,handle:".sorting-handle"})},i.prototype.UIToFields=function(){var e=[];return this.$table.find(".form-field-tr").each(function(i,t){var r=jQuery(t),d=r.find("input[type=text]"),l=d.length>0?d.val().trim():r.find(".field-placeholder").text().trim(),n=r.find(".field-type").text().trim().toLowerCase().replace(" ","_"),o="yes"===r.find(".field-required").text().trim().toLowerCase(),a=r.data("field-id");e.push({placeholder:l,type:n,required:o,id:a})}),e},i.prototype.initEvents=function(){var i=this;this.$table.on("click",".btn-form-builder-other-remove-field",function(e){e.preventDefault();var t=jQuery(e.currentTarget).closest("tr"),r=i.$table.find("tbody tr").index(t);r<0||t.hide("fast",function(e){Core.Admin.Dispatcher.publish("field:removed",i.fields[r]),i.fields=i.fields.slice(r,1),t.remove()})}),jQuery(".btn-add-form-builder-field").on("click",function(t){t.preventDefault();var r=jQuery("table.add-form-builder-field-table"),d=r.find('select[name="wof-form-builder-type"]').val().trim(),l=r.find('input[name="wof-form-builder-placeholder"]').val().trim(),n=r.find('input[name="wof-form-builder-required"]').is(":checked"),o={type:d,placeholder:l,required:n,id:e.helpers.Collections.nextAvailableName(d,i.fields)};i.fields.push(o),Core.Admin.Dispatcher.publish("field:added",o),i.drawTableRows(),window.tb_remove()})},i.prototype.setFields=function(e){this.fields=e,this.drawTableRows()},i}();i.FormBuilderOthers=t}(e.Components||(e.Components={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(t){var o=function(){function o(e,t){this.formBuilderForLists=e,this.formBuilderForOthers=t,this.steptracker=new Core.Admin.Components.StepTracker(jQuery(".step-tracker-wrapper#add-wheel")),this.setCreateMode(),this.resetStepTracker(),this.initModelUpdates(),this.initSetTheme(),this.initSaveWheel(),this.initSliceTableChanges(),this.initRestartStepTracker(),this.initWCCouponSettings()}return o.prototype.initWCCouponSettings=function(){var t=this;jQuery("[name=wc_coupon_min_spend],[name=wc_coupon_max_spend],[name=wc_coupon_discount_type]").on("change",function(o){var i=jQuery(o.currentTarget),n=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",t.activeSlice.toString()),c=i.attr("name").replace("wc_coupon_","");if(n)n[c]=i.val();else{var s={slice:t.activeSlice};s[c]=i.val(),t.model.coupon_settings.push(s)}}),jQuery("[name=wc_free_shipping]").on("change",function(o){var i=jQuery(o.currentTarget).is(":checked"),n=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",t.activeSlice.toString());n?n.free_shipping=i:t.model.coupon_settings.push({slice:t.activeSlice,free_shipping:i})}),jQuery("[name=wc_coupon_exclude_sales]").on("change",function(o){var i=jQuery(o.currentTarget).is(":checked"),n=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",t.activeSlice.toString());n?n.exclude_sales=i:t.model.coupon_settings.push({slice:t.activeSlice,exclude_sales:i})}),this.includeProducts_autocomplete=new Core.Admin.Components.MultiAutoComplete(jQuery(".wc_coupon_include_products"),function(o){var i=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",t.activeSlice.toString());i?i.include_products=o:t.model.coupon_settings.push({slice:t.activeSlice,include_products:o})}),this.excludeProducts_autocomplete=new Core.Admin.Components.MultiAutoComplete(jQuery(".wc_coupon_exclude_products"),function(o){var i=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",t.activeSlice.toString());i?i.exclude_products=o:t.model.coupon_settings.push({slice:t.activeSlice,exclude_products:o})}),this.includeCategories_autocomplete=new Core.Admin.Components.MultiAutoComplete(jQuery(".wc_coupon_include_categories"),function(o){var i=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",t.activeSlice.toString());i?i.include_categories=o:t.model.coupon_settings.push({slice:t.activeSlice,include_categories:o})}),this.excludeCategories_autocomplete=new Core.Admin.Components.MultiAutoComplete(jQuery(".wc_coupon_exclude_categories"),function(o){var i=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",t.activeSlice.toString());i?i.exclude_categories=o:t.model.coupon_settings.push({slice:t.activeSlice,exclude_categories:o})}),jQuery(".wof-slice-wrapper").on("click",".btn-wc-coupon-settings",function(o){o.preventDefault(),t.activeSlice=jQuery(o.currentTarget).data("slice"),t.excludeProducts_autocomplete.clear(),t.includeProducts_autocomplete.clear(),t.includeCategories_autocomplete.clear(),t.excludeCategories_autocomplete.clear(),jQuery("[name=wc_coupon_discount_type]").val("percent"),jQuery("[name=wc_coupon_min_spend],[name=wc_coupon_max_spend]").val(""),jQuery("[name=wc_free_shipping]").prop("checked",!1),jQuery("[name=wc_coupon_exclude_sales]").prop("checked",!1);var i=function(){window.tb_show("Coupon settings","#TB_inline?width=550&height=450&inlineId=wof-wc-coupon-options")},n=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",t.activeSlice.toString());if(n){Core.Admin.Main.loading(),jQuery("[name=wc_coupon_discount_type]").val(n.discount_type?n.discount_type:"percent"),jQuery("[name=wc_coupon_min_spend]").val(n.min_spend),jQuery("[name=wc_coupon_max_spend]").val(n.max_spend),jQuery("[name=wc_free_shipping]").prop("checked",!!n.free_shipping&&n.free_shipping),jQuery("[name=wc_coupon_exclude_sales]").prop("checked",!!n.exclude_sales&&n.exclude_sales);var c=[];n.exclude_products&&c.push(e.Api.WooCommerce.getProductNames(n.exclude_products).then(function(e){t.excludeProducts_autocomplete.setValues(e)})),n.include_products&&c.push(e.Api.WooCommerce.getProductNames(n.include_products).then(function(e){t.includeProducts_autocomplete.setValues(e)})),n.exclude_categories&&c.push(e.Api.WooCommerce.getProductCategories(n.exclude_categories).then(function(e){t.excludeCategories_autocomplete.setValues(e)})),n.include_categories&&c.push(e.Api.WooCommerce.getProductCategories(n.include_categories).then(function(e){t.includeCategories_autocomplete.setValues(e)})),jQuery.when.apply(jQuery,c).then(function(){Core.Admin.Main.loading(),i()})}else i()})},o.prototype.setEditMode=function(){this.mode="edit",jQuery(".btn-save-when-editing").show()},o.prototype.setCreateMode=function(){this.mode="create",jQuery(".btn-save-when-editing").hide()},o.prototype.resetStepTracker=function(t){void 0===t&&(t=null),"edit"===this.mode?this.steptracker.jumpToLastStep():this.steptracker.reset(),jQuery("[data-final-step]").hide(),this.model=null===t?new e.Models.Wheel:t,this.model.slices.length||(this.model.slices=jQuery("#add-wheel").data("slices"));for(var o=window.doT.template(jQuery("#tpl-woc-slice-tr").html()),i=this.model.slices,n=i.length-1;n<24;n++)i.push({id:n+1,chance:0,label:"No prize",limit:-1,type:"0",value:"",bg:null,fg:null});jQuery(".wof-slice-wrapper tbody").html(o({slices:i})),jQuery("[name=wof-wheel-theme]").removeAttr("checked").filter("[value="+this.model.theme+"]").prop("checked",!0),window.DataBind.bind(jQuery(".step-tracker-content"),this.model),setTimeout(function(){jQuery("[name=wof-slice-type]").trigger("change")},50)},o.prototype.initSliceTableChanges=function(){var t=this;jQuery(document).on("change","[name=wc_coupon_discount_type]",function(e){"percent"!==jQuery(e.currentTarget).val()?(jQuery(".wof-slice-wrapper tr[data-idx="+(t.activeSlice-1)+"] [name=wof-slice-wc-coupon-value]").show(),jQuery(".wof-slice-wrapper tr[data-idx="+(t.activeSlice-1)+"] [name=wof-slice-wc-coupon-percentage]").hide()):(jQuery(".wof-slice-wrapper tr[data-idx="+(t.activeSlice-1)+"] [name=wof-slice-wc-coupon-value]").hide(),jQuery(".wof-slice-wrapper tr[data-idx="+(t.activeSlice-1)+"] [name=wof-slice-wc-coupon-percentage]").show())}),jQuery(".wof-slice-wrapper").on("change","[name=wof-slice-type]",function(o){var i=jQuery(o.currentTarget),n=i.closest("tr").data("idx")+1,c=i.val(),s=i.closest("tr"),r=s.find("span.td-content"),l=s.find(".wof-slice-chance-wrapper"),a=s.find("[name=wof-slice-limit]");0==c?(a.hide(),r.hide(),l.hide()):(a.show(),l.show(),r.show());var u=jQuery("#ckb-woo_coupons").prop("checked");switch(r.children().hide(),s.find(".btn-wc-coupon-settings").hide(),c){case"1":if(u){var d=e.helpers.Collections.findBy(t.model.coupon_settings,"slice",n.toString());d?"percent"===d.discount_type?(r.find("[name=wof-slice-wc-coupon-percentage]").show(),r.find("[name=wof-slice-wc-coupon-value]").hide()):(r.find("[name=wof-slice-wc-coupon-value]").show(),r.find("[name=wof-slice-wc-coupon-percentage]").hide()):(r.find("[name=wof-slice-wc-coupon-percentage]").show(),r.find("[name=wof-slice-wc-coupon-value]").hide()),s.find(".btn-wc-coupon-settings").show()}else r.find("[name=wof-slice-value]").show();break;case"2":r.find("[name=wof-slice-link]").show();break;case"3":r.find("[name=wof-slice-redirect]").show();break;case"4":r.find("[name=wof-slice-texthtml]").show()}jQuery("[name=wof-slice-chance]").first().trigger("change")}),jQuery(".wof-slice-wrapper").on("change","[name=wof-slice-chance]",function(e){var o=t.getTotalPercentageOfSlices();jQuery(".wof-total-percentage").html(o.toString()).css("color",100===o?"black":"red")})},o.prototype.getTotalPercentageOfSlices=function(){var e=0;return jQuery(".wof-slice-wrapper tbody tr").each(function(t,o){var i=jQuery(o);if(!i.data("skip")){0!=i.find("[name=wof-slice-type]").val()&&(e+=parseFloat(i.find("[name=wof-slice-chance]").val()))}}),e},o.prototype.initRestartStepTracker=function(){var e=this;jQuery(".btn-start-over").on("click",function(t){t.preventDefault(),e.setCreateMode(),e.resetStepTracker()})},o.prototype.initSetTheme=function(){var e=this;this.model.theme="blue",jQuery("[name=wof-wheel-theme]").on("click",function(){e.model.theme=jQuery("[name=wof-wheel-theme]:checked").val(),Core.Admin.Dispatcher.publish("theme:changed",e.model)}),Core.Admin.Dispatcher.publish("theme:changed",this.model)},o.prototype.saveSlices=function(){var o=this;if(100!=this.getTotalPercentageOfSlices())return!1;this.model.slices=[];var i=Core.Admin.Helpers.Context.getSettings();return jQuery(".wof-slice-wrapper tbody tr").each(function(n,c){var s=jQuery(c);if(!0!==s.data("skip")){var r=s.find("[name=wof-slice-type]").val(),l=null;"true"==i.woo_coupons&&"1"==r&&(l=e.helpers.Collections.findBy(o.model.coupon_settings,"slice",(n+1).toString()));var a=null;switch(r){case"1":a="true"==i.woo_coupons?l&&"percent"!==l.discount_type?s.find("[name=wof-slice-wc-coupon-value]").val():s.find("[name=wof-slice-wc-coupon-percentage]").val():s.find("[name=wof-slice-value]").val();break;case"2":a=s.find("[name=wof-slice-link]").val();break;case"3":a=s.find("[name=wof-slice-redirect]").val();break;case"4":a=s.find("[name=wof-slice-texthtml]").val()}o.model.slices.push({id:n+1,chance:parseFloat(s.find("[name=wof-slice-chance]").val()),label:s.find("[name=wof-slice-label]").val(),limit:parseInt(s.find("[name=wof-slice-limit]").val()),type:r,value:a,bg:t.Design.currentDesignSettings.slices.bg[n],fg:t.Design.currentDesignSettings.slices.fg[n]})}}),!0},o.prototype.initSaveWheel=function(){var t=this;jQuery(".btn-save-wheel").on("click",function(o){if(o.preventDefault(),Core.Admin.Main.loading(),!t.saveSlices())return Core.Admin.Main.loading(),jQuery(".msg-incorrect-percentage").show(),t.steptracker.setStep(4),void jQuery("html, body").animate({scrollTop:jQuery(document).height()},0);jQuery(".msg-incorrect-percentage").hide();var i=e.helpers.Collections.findBy(e.Helpers.Cache.providers,"id",t.model.list_provider);t.model.fields=[],i.hideFormBuilder||null!=i&&(t.model.fields=i.isListProvider?t.formBuilderForLists.UIToFields():t.formBuilderForOthers.UIToFields()),"create"===t.mode?e.Api.Wheels.addWheel(t.model).then(function(){Core.Admin.Dispatcher.publish("wof-wheel:created"),jQuery("[data-step]").hide(),jQuery("[data-final-step]").show(),Core.Admin.Main.loading()}):e.Api.Wheels.updateWheel(t.model.id,t.model).then(function(){Core.Admin.Dispatcher.publish("wof-wheel:created"),jQuery("[data-step]").hide(),jQuery("[data-final-step]").show(),Core.Admin.Main.loading()})})},o.prototype.initModelUpdates=function(){var e=this;Core.Admin.Dispatcher.subscribe("color:changed",function(t){e.model[t.id]=t.color}),void 0!=window.tinymce&&window.tinymce.on("addeditor",function(t){var o=t.editor;o.on("change",function(t){e.model[o.id]=o.getContent()}),o.on("paste",function(t){e.model[o.id]=o.getContent()}),o.on("cut",function(t){e.model[o.id]=o.getContent()})},!0)},o}();t.CreateWheelCtrl=o}(e.Controllers||(e.Controllers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(o){var r=function(){function o(){this.$previewWheel=jQuery(".wof-wheel-preview .wof-wheel"),this.$pointer=this.$previewWheel.find(".wof-pointer-color"),this.$wheelError=this.$previewWheel.find(".wof-error"),this.$wofBackground=this.$previewWheel.find(".wof-bg"),this.$bgPatternDropdown=jQuery("select[name=bgpattern]"),this.$handlesSetting=jQuery("#ckb-handles"),this.$shadowsSetting=jQuery("#ckb-shadows"),this.$numberOfSlices=jQuery("select[name=amount_of_slices]"),this.$svgBg=this.$previewWheel.find(".wof-svg-bg"),this.$svgWheel=this.$previewWheel.find(".wof-svg-wheel"),this.$wofHandles=this.$previewWheel.find(".wof-handles"),this.$wofCircles=this.$previewWheel.find(".wof-circles"),this.$wofOrnaments=this.$previewWheel.find(".wof-svg-ornaments"),this.$wofSlices=this.$previewWheel.find(".wof-slices"),this.designs=[],this.$previewWheel.find(".wof-btn-submit").removeClass("wof-btn-submit").off("click").on("click",function(e){e.stopPropagation(),e.preventDefault()});var e=jQuery(".wof-theme-data").data("themes");for(var o in e)if(e.hasOwnProperty(o))for(var r=0;r<e[o].length;r++)this.designs.push(e[o][r]);this.backgrounds=jQuery(".wof-theme-data").data("backgrounds"),this.setDesignSettings("blue"),this.initEvents(),this.setMediaSelectors()}return o.prototype.setMediaSelectors=function(){var e=this;this.logoSelector=new Core.Admin.Components.MediaSelector(jQuery(".mabel-media-selector[data-for=logo]"),function(e){jQuery(".wof-logo").css("background-image","url("+e.sizes.full.url+")"),Core.Admin.Dispatcher.publish("logo:changed",e)},function(){jQuery(".wof-logo").css("background-image","none"),Core.Admin.Dispatcher.publish("logo:changed",{})}),this.bgSelector=new Core.Admin.Components.MediaSelector(jQuery(".mabel-media-selector[data-for=custom_bg]"),function(o){Core.Admin.Dispatcher.publish("customBg:changed",o),e.$wofBackground.css("background-image","url("+o.sizes.full.url+")"),e.$wofBackground.css({opacity:1,backgroundSize:"cover",backgroundPosition:"center center"})},function(){Core.Admin.Dispatcher.publish("customBg:changed",{}),e.$bgPatternDropdown.trigger("change")})},o.prototype.updateLogo=function(e){e?(this.logoSelector.setImageByUrl(e),jQuery(".wof-logo").css("background-image","url("+e+")")):(jQuery(".wof-logo").css("background-image","none"),this.logoSelector.removeImage())},o.prototype.updateCustomBg=function(e){e?(this.bgSelector.setImageByUrl(e),this.$wofBackground.css("background-image","url("+e+")"),this.$wofBackground.css({opacity:1,backgroundSize:"cover",backgroundPosition:"center center"})):(this.bgSelector.removeImage(),this.$wofBackground.css("background-image","none"))},o.prototype.getPreviewUrlById=function(o){var r=e.helpers.Collections.findBy(this.designs,"id",o);return r?r.preview:""},o.prototype.setDesignSettings=function(r){o.currentDesignSettings=e.helpers.Collections.findBy(this.designs,"id",r)},o.prototype.initEvents=function(){var r=this;Core.Admin.Dispatcher.subscribe("theme:changed",function(e){r.setDesignSettings(e.theme),e.pointer_color=o.currentDesignSettings.pointerColor,e.secondary_color=o.currentDesignSettings.emColor,e.bgcolor=o.currentDesignSettings.bgcolor,e.fgcolor=o.currentDesignSettings.fgcolor,e.button_bgcolor=o.currentDesignSettings.buttonBg,e.button_fgcolor=o.currentDesignSettings.buttonFg,e.error_color=o.currentDesignSettings.error,e.dots_color=o.currentDesignSettings.dots,e.wheel_color=o.currentDesignSettings.wheel,"halloween"===e.theme&&e.custom_bg&&(e.bgpattern="halloween",jQuery("select[name=bgpattern]").val("halloween")),"christmas"===e.theme&&e.custom_bg&&(e.bgpattern="christmas",jQuery("select[name=bgpattern]").val("christmas")),r.updatePreview(e)}),this.$bgPatternDropdown.on("change",function(){r.changeBackground(r.$bgPatternDropdown.val())}),this.$handlesSetting.on("change",function(){r.changeHandles()}),this.$shadowsSetting.on("change",function(){r.changeShadows()});var c=["bgcolor","pointer_color","fgcolor","button_bgcolor","button_fgcolor","secondary_color","error_color","wheel_color","dots_color","bgcolor_slice_1","bgcolor_slice_2","bgcolor_slice_3","bgcolor_slice_4","bgcolor_slice_5","bgcolor_slice_6","bgcolor_slice_7","bgcolor_slice_8","bgcolor_slice_9","bgcolor_slice_10","bgcolor_slice_11","bgcolor_slice_12","bgcolor_slice_13","bgcolor_slice_14","bgcolor_slice_15","bgcolor_slice_16","bgcolor_slice_17","bgcolor_slice_18","bgcolor_slice_19","bgcolor_slice_20","bgcolor_slice_21","bgcolor_slice_22","bgcolor_slice_23","bgcolor_slice_24","fgcolor_slice_1","fgcolor_slice_2","fgcolor_slice_3","fgcolor_slice_4","fgcolor_slice_5","fgcolor_slice_6","fgcolor_slice_7","fgcolor_slice_8","fgcolor_slice_9","fgcolor_slice_10","fgcolor_slice_11","fgcolor_slice_12","fgcolor_slice_13","fgcolor_slice_14","fgcolor_slice_15","fgcolor_slice_16","fgcolor_slice_17","fgcolor_slice_18","fgcolor_slice_19","fgcolor_slice_20","fgcolor_slice_21","fgcolor_slice_22","fgcolor_slice_23","fgcolor_slice_14"];Core.Admin.Dispatcher.subscribe("color:changed",function(s){var l=e.helpers.Collections.findBy(r.designs,"id",r.currentTheme);if(l&&-1!==jQuery.inArray(s.id,c))switch(s.id){case"bgcolor":r.$previewWheel.css("backgroundColor",s.color?s.color:l.bgcolor);break;case"pointer_color":r.$pointer.css("fill",s.color?s.color:l.pointerColor);break;case"fgcolor":r.$previewWheel.find(".wof-fgcolor").css("color",s.color?s.color:l.fgcolor);break;case"button_bgcolor":r.$previewWheel.find("button").css("backgroundColor",s.color?s.color:l.buttonBg);break;case"button_fgcolor":r.$previewWheel.find("button").css("color",s.color?s.color:l.buttonFg);break;case"secondary_color":r.$previewWheel.find("em").css("color",s.color?s.color:l.emColor);break;case"error_color":r.$wheelError.css({color:s.color,borderColor:s.color});break;case"dots_color":r.$wofCircles.css("fill",s.color);break;case"wheel_color":r.$wofHandles.css("fill",s.color),r.$svgWheel.find("circle").first().css("stroke",s.color),r.$svgWheel.find("circle").last().css("fill",s.color);break;case"fgcolor_slice_1":case"fgcolor_slice_2":case"fgcolor_slice_3":case"fgcolor_slice_4":case"fgcolor_slice_5":case"fgcolor_slice_6":case"fgcolor_slice_7":case"fgcolor_slice_8":case"fgcolor_slice_9":case"fgcolor_slice_10":case"fgcolor_slice_11":case"fgcolor_slice_12":case"fgcolor_slice_13":case"fgcolor_slice_14":case"fgcolor_slice_15":case"fgcolor_slice_16":case"fgcolor_slice_17":case"fgcolor_slice_18":case"fgcolor_slice_19":case"fgcolor_slice_20":case"fgcolor_slice_21":case"fgcolor_slice_22":case"fgcolor_slice_23":case"fgcolor_slice_24":var i=s.id.replace("fgcolor_slice_","");r.$previewWheel.find(".wof-slice[data-slice="+i+"]").css("color",s.color),o.currentDesignSettings.slices.fg[i-1]=s.color;break;case"bgcolor_slice_1":case"bgcolor_slice_2":case"bgcolor_slice_3":case"bgcolor_slice_4":case"bgcolor_slice_5":case"bgcolor_slice_6":case"bgcolor_slice_7":case"bgcolor_slice_8":case"bgcolor_slice_9":case"bgcolor_slice_10":case"bgcolor_slice_11":case"bgcolor_slice_12":case"bgcolor_slice_13":case"bgcolor_slice_14":case"bgcolor_slice_15":case"bgcolor_slice_16":case"bgcolor_slice_17":case"bgcolor_slice_18":case"bgcolor_slice_19":case"bgcolor_slice_20":case"bgcolor_slice_21":case"bgcolor_slice_22":case"bgcolor_slice_23":case"bgcolor_slice_24":var i=s.id.replace("bgcolor_slice_","");r.$previewWheel.find(".wof-slice-bg[data-slice="+i+"]").css("fill",s.color),o.currentDesignSettings.slices.bg[i-1]=s.color}}),this.$numberOfSlices.on("change",function(c){var s=parseInt(jQuery(c.currentTarget).val()),l=360/s;jQuery(".slice-colors tbody tr").each(function(e,o){var r=jQuery(o);r.data("slice")<=s?r.show():r.hide()}),jQuery(".wof-slice-wrapper tbody tr").each(function(e,o){var r=jQuery(o);r.data("idx")+1<=s?(r.show(),r.data("skip",!1)):(r.hide(),r.data("skip",!0))}),jQuery("[name=wof-slice-chance]").first().trigger("change"),r.$previewWheel.find(".wof-slice-bg").each(function(o,r){var c=jQuery(r);c.data("slice")<=s?(c.show(),c.attr("d",e.helpers.Wheels.getSlicePathAttribute(o,s))):c.hide()});var i=r.$svgBg.find("g").attr("transform"),t=i.replace(/rotate\(([^\)]*)\)/,"rotate(-"+l/2+" 0 0)");r.$svgBg.find("g").attr("transform",t),r.$wofSlices.children().remove();for(var n=0;n<s;n++){var a=l*n,g=jQuery('<div data-slice="'+(n+1)+'" style="-webkit-transform:rotate('+a+"deg) translate(0px, -50%);transform:rotate("+a+'deg) translate(0px, -50%);" class="wof-slice">Text</div>');g.css("color",o.currentDesignSettings.slices.fg[n]),r.$wofSlices.append(g)}r.$wofHandles.children().remove();for(var n=0;n<s;n++){var _=r.getUseNode("#b",{transform:"rotate("+l*n+" 512 512)"});r.$wofHandles.append(jQuery(_))}r.$wofCircles.children().remove();for(var n=0;n<s;n++){var _=r.getUseNode("#c",{transform:"rotate("+l*n+" 512 512)"});r.$wofCircles.append(jQuery(_))}var f=360/s/2+15;r.$wofOrnaments.attr("transform",""),r.$wofOrnaments.attr("transform","scale(1.022,1.022) rotate("+f+")")})},o.prototype.updateSliceColors=function(e,r){for(var c=0;c<r.length;c++)o.currentDesignSettings.slices.fg[c]=r[c];for(var c=0;c<e.length;c++)o.currentDesignSettings.slices.bg[c]=e[c]},o.prototype.getUseNode=function(e,o){var r=document.createElementNS("http://www.w3.org/2000/svg","use");r.setAttributeNS(null,"href",e),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e);for(var c in o)r.setAttributeNS(null,c,o[c]);return r},o.prototype.updatePreview=function(e){this.currentTheme=e.theme;for(var r=o.currentDesignSettings.slices.fg,c=0;c<r.length;c++)Core.Admin.Main.setColorPickerColor("fgcolor_slice_"+(c+1),r[c]);for(var s=o.currentDesignSettings.slices.bg,c=0;c<s.length;c++)Core.Admin.Main.setColorPickerColor("bgcolor_slice_"+(c+1),s[c]);Core.Admin.Main.setColorPickerColor("pointer_color",e.pointer_color),Core.Admin.Main.setColorPickerColor("secondary_color",e.secondary_color),Core.Admin.Main.setColorPickerColor("bgcolor",e.bgcolor),Core.Admin.Main.setColorPickerColor("fgcolor",e.fgcolor),Core.Admin.Main.setColorPickerColor("button_bgcolor",e.button_bgcolor),Core.Admin.Main.setColorPickerColor("button_fgcolor",e.button_fgcolor),Core.Admin.Main.setColorPickerColor("error_color",e.error_color),Core.Admin.Main.setColorPickerColor("wheel_color",e.wheel_color),Core.Admin.Main.setColorPickerColor("dots_color",e.dots_color),this.bgSelector.hasSelected||this.changeBackground(e.bgpattern),this.changeHandles(),this.changeShadows()},o.prototype.changeHandles=function(){this.$handlesSetting.is(":checked")?this.$wofHandles.show():this.$wofHandles.hide()},o.prototype.changeShadows=function(){this.$shadowsSetting.is(":checked")?(this.$svgWheel.find("circle").attr("filter","url(#outer)"),this.$pointer.siblings(".wof-pointer-shadow").attr("opacity",.2)):(this.$svgWheel.find("circle").attr("filter",""),this.$pointer.siblings(".wof-pointer-shadow").attr("opacity",0))},o.prototype.changeBackground=function(o){var r=e.helpers.Collections.findBy(this.backgrounds,"id",o);if(r){var c=r.url?r.url:Core.Admin.Helpers.Context.getBaseUrl()+"public/img/bg-"+o+".png";this.$wofBackground.css("backgroundImage","url("+c+")"),this.$wofBackground.css({opacity:r.opacity,backgroundSize:r.size})}},o}();o.Design=r}(e.Controllers||(e.Controllers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(t){var i=function(){function t(){this.$gdprSettingsWrapper=jQuery("[name=gdpr_settings]").closest("tr").hide(),this.$checkboxesContainer=jQuery(".wof-checkboxes-list"),this.$noCheckboxesBubble=jQuery(".wof-gdpr-options-no-checkbox"),this.$hiddenInput=this.$gdprSettingsWrapper.find("input[type=hidden]"),this.initEvents()}return t.prototype.addOptionToGdprSettingUI=function(e,t){void 0===t&&(t=!1),this.$checkboxesContainer.append(jQuery('<div style="padding-top:7px;"><input name="wof-gdpr-option[]" '+(t?'checked="checked"':"")+' data-field-id="'+e.id+'" type="checkbox" id="gdpr-option-'+e.id+'" /> <label for="gdpr-option-'+e.id+'">'+e.placeholder+"</label></div>"))},t.prototype.initGdprSettingOptions=function(t,i){var n=this;i=i?i.split(","):[],this.$checkboxesContainer.empty();var o=e.helpers.Collections.findAllBy(t,"type","consent_checkbox");o.length?this.$noCheckboxesBubble.hide():this.$noCheckboxesBubble.show(),o.forEach(function(e,t){var o=i.indexOf(e.id)>-1;"consent_checkbox"===e.type&&n.addOptionToGdprSettingUI(e,o)}),this.$hiddenInput.val(i),this.$hiddenInput[0].dispatchEvent(new Event("input"))},t.prototype.initEvents=function(){var e=this;Core.Admin.Dispatcher.subscribe("field:removed",function(t){jQuery("input[type=checkbox]#gdpr-option-"+t.id).closest("div").remove();var i=e.$hiddenInput.val().split(","),n=i.indexOf(t.id);n>-1&&i.splice(n,1),e.$hiddenInput.val(i.join(","))}),Core.Admin.Dispatcher.subscribe("field:added",function(t){e.addOptionToGdprSettingUI(t,!1)}),jQuery(".wof-checkboxes-list").on("change","input[type=checkbox]",function(t){var i=[];jQuery("input[name='wof-gdpr-option[]']:checked").each(function(e,t){i.push(jQuery(t).data("field-id"))}),e.$hiddenInput.val(i.join(",")),e.$hiddenInput[0].dispatchEvent(new Event("input"))}),Core.Admin.Dispatcher.subscribe("provider:changed",function(t){"none"===t.provider||"chatfuel"===t.provider?e.$gdprSettingsWrapper.closest("tr").hide():e.$gdprSettingsWrapper.closest("tr").show()})},t}();t.Gdpr=i}(e.Controllers||(e.Controllers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(t){!function(i){var n=function(){function i(){var t=this;this.settingLoaded=!1,this.classList=["one","two","three","four","five","six"],this.$integrationCards=jQuery(".integration-tile"),this.$settingPanes=[],Core.Admin.Dispatcher.subscribe("tab:changed",function(i){t.settingLoaded||"options-apis"!==i||(t.$integrationCards.each(function(i,n){var e=jQuery(n),s=e.data("id"),r=jQuery('<div class="wof-integration-settings">').hide(),a=jQuery('.wof-integrations-settings-wrapper[data-for="'+s+'"]'),o=a.clone(!0,!0);r.append(o.show()),a.remove();var d=t.calculateItemsPerRow(),c=t.$integrationCards.index(e),g=Math.floor(c/d),u=g*d+d,h=(c+1)%d==0?d-1:(c+1)%d-1;r.addClass("wof-"+t.classList[h]),r.insertAfter(t.$integrationCards.eq(u>t.$integrationCards.length?t.$integrationCards.length-1:u-1)),t.$settingPanes.push({id:s,pane:r})}),t.settingLoaded=!0)}),this.initEvents()}return i.prototype.initEvents=function(){var i=this;this.$integrationCards.on("click",function(n){n.preventDefault();var e=jQuery(n.currentTarget),s=t.helpers.Collections.findBy(i.$settingPanes,"id",e.data("id")).pane;s.is(":visible")?s.hide():(jQuery(".wof-integration-settings").hide(),s.show())})},i.prototype.calculateItemsPerRow=function(){var t=0,i=this.$integrationCards.eq(0),n=i.position().top;return this.$integrationCards.each(function(i,e){jQuery(e).position().top===n&&(t=i+1)}),t},i}();i.Integrations=n}(t.Controllers||(t.Controllers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(t){!function(e){var i=function(){function e(){this.$wheelsList=jQuery(".wof-wheels-list"),this.getWheelsList(),this.initEditWheel(),this.initDeleteWheel(),this.initDuplicateWheel(),this.initToggleActivation(),this.initStats(),this.initViewOptinsAndPlays(),this.initExportOptins(),this.initExportPlays(),this.initDeleteLogs()}return e.prototype.initToggleActivation=function(){this.$wheelsList.on("click",".wof-toggle-active",function(e){var i=jQuery(e.currentTarget);t.Api.Wheels.toggleActivation(i.data("wheel"),i.is(":checked")?1:0)})},e.prototype.getWheelsList=function(){var e=this;t.Api.Wheels.getStatistics().then(function(t){e.statistics=t}),t.Api.Wheels.getWheels().then(function(t){if(e.wheels=t,0===e.wheels.length)jQuery(".wof-no-results").show();else{jQuery(".wof-no-results").hide();var i=window.doT.template(jQuery("#tpl-wof-wheels-list").html());e.$wheelsList.html(i({wheels:t}))}})},e.prototype.initDuplicateWheel=function(){var e=!1;this.$wheelsList.on("click",".wof-duplicate-wheel",function(i){if(i.preventDefault(),!e){e=!0;var n=jQuery(i.currentTarget);n.css("opacity",.5),t.Api.Wheels.getWheel(n.data("wheel")).then(function(i){i.id=null,t.Api.Wheels.addWheel(i).then(function(){Core.Admin.Dispatcher.publish("wof-wheel:created"),e=!1,n.css("opacity",1)})})}})},e.prototype.initEditWheel=function(){this.$wheelsList.on("click",".wof-edit-wheel",function(e){e.preventDefault(),Core.Admin.Main.loading();var i=jQuery(e.currentTarget);t.Api.Wheels.getWheel(i.data("wheel")).then(function(t){Core.Admin.Dispatcher.publish("wof-wheel:edit",t)})})},e.prototype.initDeleteWheel=function(){this.$wheelsList.on("click",".wof-delete-wheel",function(e){e.preventDefault();var i=jQuery(e.currentTarget);t.Api.Wheels.deleteWheel(i.data("wheel")).then(function(){i.closest(".image-tile").hide()})})},e.prototype.initExportOptins=function(){jQuery(".wof-btn-export-optins-csv").on("click",function(t){t.preventDefault(),window.location.href="?page=mabel-wheel-of-fortune&wof-optins-csv&wheel_id="+jQuery(t.currentTarget).data("wheel")})},e.prototype.initExportPlays=function(){jQuery(".wof-btn-export-plays-csv").on("click",function(t){t.preventDefault(),window.location.href="?page=mabel-wheel-of-fortune&wof-plays-csv&wheel_id="+jQuery(t.currentTarget).data("wheel")})},e.prototype.initDeleteLogs=function(){jQuery(".wof-btn-delete-logs").on("click",function(e){var i=jQuery(e.currentTarget);i.html("Deleting..."),e.preventDefault(),t.Api.Log.deleteOptins(jQuery(e.currentTarget).data("wheel")).then(function(){i.html("Deleted!"),jQuery("table.wof-optins-log tbody").html("")})})},e.prototype.initViewOptinsAndPlays=function(){var e=this;this.$wheelsList.on("click",".wof-view-optins",function(i){i.preventDefault(),Core.Admin.Main.loading();var n=t.helpers.Collections.findBy(e.wheels,"id",jQuery(i.currentTarget).data("wheel"));if(null!==n){jQuery(".wof-btn-export-optins-csv").data("wheel",n.id),jQuery(".wof-btn-export-plays-csv").data("wheel",n.id),jQuery(".wof-btn-delete-logs").data("wheel",n.id);var o=jQuery("table.wof-optins-log"),l=o.find("tbody");l.empty(),t.Api.Log.getLastOptins(n.id).then(function(t){for(var e=0;e<t.length;e++){var i=t[e],n=jQuery("<tr>");n.append("<td>"+i.date+"</td>"),n.append("<td>"+i.type+"</td>"),n.append("<td>"+i.log+"</td>"),l.append(n)}window.tb_show("Last 30 logs","#TB_inline?width=800&height=550&inlineId=wof-optins-log-modal"),Core.Admin.Main.loading()})}})},e.prototype.initStats=function(){var t=this;this.$wheelsList.on("click",".wof-get-statistics",function(e){var i=jQuery(e.currentTarget),n=t.getStatsById(i.data("wheel")),o=window.doT.template(jQuery("#tpl-wof-statistics-modal").html());jQuery("#wof-statistics-modal").html(o(n)),window.tb_show("Wheels of Fortune statistics","#TB_inline?width=550&height=400&inlineId=wof-statistics-modal")})},e.prototype.getStatsById=function(t){for(var e=0;e<this.statistics.length;e++)if(this.statistics[e].wheel_id===t)return this.statistics[e];return null},e}();e.WheelsListCtrl=i}(t.Controllers||(t.Controllers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var i=function(){function n(){}return n.providers=[],n}();n.Cache=i}(n.Helpers||(n.Helpers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var r=function(){function r(){}return r.nextAvailableName=function(r,t){var i=n.Collections.findAllBy(t,"type",r),e=0;return i.forEach(function(n,r){var t=n.id.replace(/^\D+/g,"");t&&parseInt(t)>e&&(e=parseInt(t))}),r+"_"+(e+1).toString()},r.findAllBy=function(n,r,t){var i=[];return n&&n.length?(n.forEach(function(n,e){n[r]==t&&i.push(n)}),i):i},r.findBy=function(n,r,t){if(!n||!n.length)return null;var i=null;return n.forEach(function(n,e){n[r]==t&&(i=n)}),i},r}();n.Collections=r}(n.helpers||(n.helpers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(e){var r=function(){function e(){}return e.providerToText=function(e){switch(e){case"mailchimp":return"Mailchimp";case"ac":return"ActiveCampaign";case"cm":return"Campaign Monitor";case"zbscrm":return"Zero BS CRM";case"wordpress":return"WordPress";case"none":return"None";case"custom":return"Zapier";case"gr":return"GetResponse";case"ml":return"MailerLite";case"kv":return"Klaviyo";case"mailster":return"Mailster";case"rm":return"Remarkety";case"chatfuel":return"ChatFuel";case"newsletter2go":return"Newsletter2Go";case"sib":return"SendInBlue";default:return e}},e.capitalizeWords=function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},e}();e.Strings=r}(e.helpers||(e.helpers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(t){!function(t){var n=function(){function t(){}return t.getCoordinatesForPercent=function(t,n){var e=t*n,r=t*(n+1);return{start:{x:Math.cos(2*Math.PI*e),y:Math.sin(2*Math.PI*e)},end:{x:Math.cos(2*Math.PI*r),y:Math.sin(2*Math.PI*r)}}},t.getSlicePathAttribute=function(t,n){var e=100/n/100,r=this.getCoordinatesForPercent(e,t);return["M "+r.start.x+" "+r.start.y,"A 1 1 0 0 1 "+r.end.x+" "+r.end.y,"L 0 0"].join(" ")},t.createSlicePath=function(t,n,e){return'<path fill="'+e+'" d="'+this.getSlicePathAttribute(t,n)+'"></path>'},t.calculateDashArray=function(t,n){return"0 "+(n-1)/t*100+" "+100*(1/t+.05)+" 100"},t}();t.Wheels=n}(t.helpers||(t.helpers={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var i=function(){function n(){this.required=!1,this.type="text"}return n}();n.Field=i}(n.Models||(n.Models={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var i=function(){function n(){this.limit=-1}return n}();n.Slice=i}(n.Models||(n.Models={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(n){!function(n){var i=function(){function n(){}return n}();n.Statistics=i}(n.Models||(n.Models={}))}(WOFAdmin||(WOFAdmin={}));
var WOFAdmin;!function(e){!function(e){var i=function(){function e(){this.usage="popup",this.theme="blue",this.amount_of_slices=12,this.slices=[],this.active="1",this.winning_chance=70,this.limit_prizes=!1,this.plays=0,this.bgpattern="hearts",this.title="Get your chance to <em>win a prize</em>!",this.explainer="Enter your email address and spin the wheel. This is your chance to win amazing discounts!",this.disclaimer="Our in-house rules:<ul><li>One game per user</li><li>Cheaters will be disqualified.</li></ul>",this.email_placeholder="Your email",this.button_text="Try your luck",this.button_done="I'm done playing",this.close_text="I don't feel lucky",this.losing_title="Uh oh! Looks like you lost",this.losing_text="We're sorry, the wheel of fortune has let you down. Better luck next time!",this.winning_title="Hurray! You've hit {x}. Lucky you!",this.winning_text_coupon="Nicely done! You can use the coupon code below to claim your prize:",this.winning_text_link="Nicely done! here's the link to your free product:",this.button_again="Try again",this.games_left_text="You have {x} spins left",this.email_already_used="This email address is already used",this.email_coupon_subject="Congrats, you won!",this.email_coupon_message="Hi there,<br/><br/>Congratulations, you won {label}! Here's your code:<br/>{coupon}<br/><br/>Enjoy shopping!",this.email_link_subject="Congrats, you won!",this.email_link_message="Hi there,<br/><br/>Congratulations, you won a free product! Here's the link to your ebook:<br/>{link}<br/><br/>Enjoy!",this.email_noprize_subject="Sorry you lost - here's a gift",this.email_noprize_message="Hi there,<br/><br/>We're sorry you didn't win this time. Grab another chance tomorrow!",this.email_html_message="Hi there,<br/><br/>This is an email to inform you you've won! Here's your prize:<br/>{value}<br/><br/>Enjoy!",this.email_html_subject="Congrats, you won!",this.email_redirect_subject="Congrats, you won!",this.email_redirect_message="Hi there,<br/><br/>Congratulations, you won a free ebook! Here's the link to download it:{link}<br/>Enjoy!",this.user_inclusion="0",this.appeartype="exit",this.appeardelay=5,this.appearscroll=60,this.occurance="session",this.occurancedelay=14,this.retry_occurance="session",this.occurance_after_delay=5,this.hide_mobile=!0,this.hide_desktop=!1,this.hide_tablet=!1,this.fields=[],this.coupon_settings=[],this.coupon_bar=!1,this.woo_auto_apply=!1,this.bar_text="Your coupon code {code} is valid for {countdown}",this.bar_days="d",this.bar_hours="h",this.bar_minutes="m",this.bar_seconds="s"}return e}();e.Wheel=i}(e.Models||(e.Models={}))}(WOFAdmin||(WOFAdmin={}));
"use strict";!function(e){"function"==typeof define&&define.amd?define(e):window.DataBind=e()}(function(){function e(e){return e&&window.jQuery&&e instanceof window.jQuery}function t(t){return e(t)?t[0]:t}function n(e,t){if(e){var n=void 0!==t;if(["checkbox","radio"].indexOf(e.type)>=0)return n&&(e.checked=!!t),e.checked;if(["text","hidden","textarea","select-one","email","url","week","time","search","tel","range","number","month","datetime-local","date","color","password"].indexOf(e.type)>=0){if(n){e.value=t;var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!1),e.dispatchEvent(o)}return e.value}if(["select-multiple"].indexOf(e.type)>=0){n&&(r(t)||(t=[t]));for(var i,a=[],c=e&&e.options,f=0,u=c.length;f<u;f++)i=c[f],n&&(t.indexOf(i.value)>-1?i.selected=!0:i.selected=!1),i.selected&&a.push(i.value||i.text);return a}return n&&(e.innerText=t),e.innerText}}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return["checkbox","radio","select-one","select-multiple","password"].indexOf(e.type)>=0?"change":["text","hidden","textarea","email","url","week","time","search","tel","range","number","month","datetime-local","date","color"].indexOf(e.type)>=0?"input":void 0}function i(e){return e.hashkey||(e.hashkey=Date.now()+Math.floor(1e5*Math.random())),e.hashkey}function a(e,t){if(e&&t){var n=i(e);if(M[n]=M[n]||[],!(M[n].indexOf(t)>-1)){M[n].push(t);var r=o(e);e.addEventListener(r,t,!1)}}}function c(e,t){var n=i(e),r=M[n].indexOf(t);if(M[n]&&-1!==r){M[n].splice(r,1);var a=o(e);e.removeEventListener(a,t,!1)}}function f(e){var t=i(e),n=M[t];if(e&&n){var r,o=n.concat(),a=o.length;for(r=0;r<a;r++)c(e,o[r])}}function u(e,t){function n(){var e,t,n=!1;return t=o.exec(i[r]),t&&t.length&&(e=i[r].split("[")[0],a=a[e][+t[1]],n=!0),n}var r,o=new RegExp(/.*\[(\d+)\]/),i=t.split("."),a=e;for(r=0;r<i.length-1;r++)n()||(a=a[i[r]]);return n(),a}function l(e,t,n){var r=t.split("."),o=u(e,t);return void 0!==n&&(o[r[r.length-1]]=n),o[r[r.length-1]]}function d(e,t,r){a(e,function(e,t,n,r,o,i,a,c){return function(e){var f=o(this),u=i(this),l=r(t,n);r(t,n,f),a(c,this,{key:u,oldValue:l,newValue:f})}}(0,t,r,l,n,v,j,_))}function s(e){f(e)}function h(e,t,r){var o=function(e,t,n,r,o,i,a){return function(t,n,c,f){var t=i(e);r(e,c),o(a,e,{key:t,oldValue:f,newValue:c})}}(e,0,0,n,j,v,S);k.watch(t,r,o)}function p(e,t){var n,r=e.watchers[t];for(n=0;n<r.length;n++)k.unwatch(e,t,r[n])}function v(e){if(e)return e.getAttribute(L)}function y(e){return e=e||{},e={dom:void 0===e.dom||e.dom,model:void 0===e.model||e.model,children:void 0===e.children||e.children}}function m(e,t){if(!e||!t)return{};var n=v(e);if(!n)return{};var r=u(t,n),o=n.split(".");return o=o[o.length-1],{key:n,deepKey:o,deepModel:r,keyExists:!!r}}function g(e,t,r){if(!e||!t)return!1;var o=m(e,t);return!!o.keyExists&&(n(e,l(t,o.key)),r.dom&&d(e,o.deepModel,o.deepKey),r.model&&h(e,o.deepModel,o.deepKey),!0)}function w(e,t,n){if(e&&t){var r=m(e,t);r.keyExists&&(n.dom&&s(e),n.model&&p(r.deepModel,r.deepKey))}}function b(e,t){var n,r,o=[e];if(t.children)for(n=e.getElementsByTagName("*"),r=0;r<n.length;r++)o.push(n[r]);return o}function j(e,t,n){var r=document.createEvent("Events");r.initEvent(e,!0,!0),r.data=n,t.dispatchEvent(r)}function x(e,t,n,r){function o(e,o){u.push(o),r.dom&&e.addEventListener(n,o,!1),r.model&&e.addEventListener(t,o,!1)}function i(e,t){var n=u.indexOf(t);-1!==n&&(u.splice(n,1),r.dom&&e.removeEventListener(_,t,!1),r.model&&e.removeEventListener(S,t,!1))}function a(e){var t,n=u.concat();for(t=0;t<n.length;t++)i(e,n[t])}function c(t){var n;for(n=0;n<e.length;n++)o(e[n],t)}function f(t){var n,r=i;for(void 0===t&&(r=a),n=0;n<e.length;n++)r(e[n],t)}var u=[];return{watch:c,unwatch:f}}function O(e,n,r){if(e&&n){var o=t(e);if(o!==e)return arguments[0]=o,O.apply(this,arguments);r=y(r);var i,a=b(e,r),c=[];for(i=0;i<a.length;i++)g(a[i],n,{dom:r.dom,model:r.model})&&c.push(a[i]);var f=new x(c,S,_,r);return e.watchable=f,f}}function E(e,n,r){if(e&&n){var o=t(e);if(o!==e)return arguments[0]=o,E.apply(this,arguments);r=y(r);var i,a=b(e,r);for(i=0;i<a.length;i++)w(a[i],n,{dom:r.dom,model:r.model});e.watchable.unwatch()}}var k=function(){var e={noMore:!1},t=[],n=function(e){var t={};return e&&"[object Function]"==t.toString.call(e)},r=function(e){return e%1==0},o=function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=function(e,t){var n=[],r=[];if("string"!=typeof e&&"string"!=typeof t&&!o(e)&&!o(t)){for(var i in e)t[i]||n.push(i);for(var a in t)e[a]||r.push(a)}return{added:n,removed:r}},a=function(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)t[n]=e[n];return t},c=function(e,t,n,r){try{Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}catch(o){try{Object.prototype.__defineGetter__.call(e,t,n),Object.prototype.__defineSetter__.call(e,t,r)}catch(e){throw"watchJS error: browser not supported :/"}}},f=function(e,t,n){try{Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!1,value:n})}catch(r){e[t]=n}},u=function(){n(arguments[1])?l.apply(this,arguments):o(arguments[1])?d.apply(this,arguments):s.apply(this,arguments)},l=function(e,t,n,r){if("string"!=typeof e&&(e instanceof Object||o(e))){var i=[];if(o(e))for(var a=0;a<e.length;a++)i.push(a);else for(var c in e)i.push(c);d(e,i,t,n,r)}},d=function(e,t,n,r,i){if("string"!=typeof e&&(e instanceof Object||o(e)))for(var a in t)s(e,t[a],n,r,i)},s=function(e,t,r,i,a){"string"!=typeof e&&(e instanceof Object||o(e))&&(n(e[t])||(null!=e[t]&&(void 0===i||i>0)&&(void 0!==i&&i--,l(e[t],r,i)),y(e,t,r),a&&O(e,t,r,i)))},h=function(){n(arguments[1])?p.apply(this,arguments):o(arguments[1])?v.apply(this,arguments):j.apply(this,arguments)},p=function(e,t){if(!(e instanceof String)&&(e instanceof Object||o(e))){var n=[];if(o(e))for(var r=0;r<e.length;r++)n.push(r);else for(var i in e)n.push(i);v(e,n,t)}},v=function(e,t,n){for(var r in t)j(e,t[r],n)},y=function(t,n,r){var o=t[n];b(t,n),t.watchers||f(t,"watchers",{}),t.watchers[n]||(t.watchers[n]=[]);for(var i in t.watchers[n])if(t.watchers[n][i]===r)return;t.watchers[n].push(r),c(t,n,function(){return o},function(i){var a=o;o=i,t[n]&&l(t[n],r),b(t,n),e.noMore||JSON.stringify(a)!==JSON.stringify(i)&&(m(t,n,"set",i,a),e.noMore=!1)})},m=function(e,t,n,o,i){for(var a in e.watchers[t])r(a)&&e.watchers[t][a].call(e,t,n,o,i)},g=["pop","push","reverse","shift","sort","slice","unshift"],w=function(e,t,n,r){f(e[t],r,function(){var o=n.apply(e[t],arguments);return s(e,e[t]),"slice"!==r&&m(e,t,r,arguments),o})},b=function(e,t){if(e[t]&&!(e[t]instanceof String)&&o(e[t]))for(var n,r=g.length;r--;)n=g[r],w(e,t,e[t][n],n)},j=function(e,t,n){for(var r in e.watchers[t]){e.watchers[t][r]==n&&e.watchers[t].splice(r,1)}E(e,t,n)},x=function(){for(var e in t){var n=t[e],r=i(n.obj[n.prop],n.actual);if(r.added.length||r.removed.length){if(r.added.length)for(var o in n.obj.watchers[n.prop])d(n.obj[n.prop],r.added,n.obj.watchers[n.prop][o],n.level-1,!0);m(n.obj,n.prop,"differentattr",r,n.actual)}n.actual=a(n.obj[n.prop])}},O=function(e,n,r,o){t.push({obj:e,prop:n,actual:a(e[n]),watcher:r,level:o})},E=function(e,n,r){for(var o in t){var i=t[o];i.obj==e&&i.prop==n&&i.watcher==r&&t.splice(o,1)}};return setInterval(x,50),e.watch=u,e.unwatch=h,e.callWatchers=m,e}(),M={},S="databind-model-change",_="databind-dom-change",L="data-key";return{bind:O,unbind:E}});
!function(){"use strict";function e(n,t,r){return("string"==typeof t?t:t.toString()).replace(n.define||a,function(e,t,o,a){return 0===t.indexOf("def.")&&(t=t.substring(4)),t in r||(":"===o?(n.defineParams&&a.replace(n.defineParams,function(e,n,o){r[t]={arg:n,text:o}}),t in r||(r[t]=a)):new Function("def","def['"+t+"']="+a)(r)),""}).replace(n.use||a,function(t,o){n.useParams&&(o=o.replace(n.useParams,function(e,n,t,o){if(r[t]&&r[t].arg&&o){var a=(t+":"+o).replace(/'|\\/g,"_");return r.__exp=r.__exp||{},r.__exp[a]=r[t].text.replace(new RegExp("(^|[^\\w$])"+r[t].arg+"([^\\w$])","g"),"$1"+o+"$2"),n+"def.__exp['"+a+"']"}}));var a=new Function("def","return "+o)(r);return a?e(n,a,r):a})}function n(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var t,r={engine:"doT",version:"1.1.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0};r.encodeHTMLSource=function(e){var n={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(t,function(e){return n[e]||e}):""}},t=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=r:"function"==typeof define&&define.amd?define(function(){return r}):t.doT=r;var o={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},a=/$^/;r.template=function(c,i,u){i=i||r.templateSettings;var d,s,p=i.append?o.append:o.split,l=0,f=i.use||i.define?e(i,c,u||{}):c;f=("var out='"+(i.strip?f.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):f).replace(/'|\\/g,"\\$&").replace(i.interpolate||a,function(e,t){return p.start+n(t)+p.end}).replace(i.encode||a,function(e,t){return d=!0,p.startencode+n(t)+p.end}).replace(i.conditional||a,function(e,t,r){return t?r?"';}else if("+n(r)+"){out+='":"';}else{out+='":r?"';if("+n(r)+"){out+='":"';}out+='"}).replace(i.iterate||a,function(e,t,r,o){return t?(l+=1,s=o||"i"+l,t=n(t),"';var arr"+l+"="+t+";if(arr"+l+"){var "+r+","+s+"=-1,l"+l+"=arr"+l+".length-1;while("+s+"<l"+l+"){"+r+"=arr"+l+"["+s+"+=1];out+='"):"';} } out+='"}).replace(i.evaluate||a,function(e,t){return"';"+n(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),d&&(i.selfcontained||!t||t._encodeHTML||(t._encodeHTML=r.encodeHTMLSource(i.doNotSkipEncoded)),f="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+r.encodeHTMLSource.toString()+"("+(i.doNotSkipEncoded||"")+"));"+f);try{return new Function(i.varname,f)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+f),e}},r.compile=function(e,n){return r.template(e,null,n)}}();
!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&void 0!==module.exports?module.exports=t():window.Sortable=t()}(function(){"use strict";function t(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=_({},e),t[V]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0}};for(var i in n)!(i in e)&&(e[i]=n[i]);rt(e);for(var o in this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!e.forceFallback&&K,a(t,"mousedown",this._onTapStart),a(t,"touchstart",this._onTapStart),a(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(a(t,"dragover",this),a(t,"dragenter",this)),ot.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function e(t,e){"clone"!==t.lastPullMode&&(e=!0),S&&S.state!==e&&(l(S,"display",e?"none":""),e||S.state&&(t.options.group.revertClone?(E.insertBefore(S,x),t._animate(w,S)):E.insertBefore(S,w)),S.state=e)}function n(t,e,n){if(t){n=n||z;do{if(">*"===e&&t.parentNode===n||m(t,e))return t}while(t=i(t))}return null}function i(t){var e=t.host;return e&&e.nodeType?e:t.parentNode}function o(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.preventDefault()}function a(t,e,n){t.addEventListener(e,n,J)}function r(t,e,n){t.removeEventListener(e,n,J)}function s(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(H," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(H," ")}}function l(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return z.defaultView&&z.defaultView.getComputedStyle?n=z.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||(e="-webkit-"+e),i[e]=n+("string"==typeof n?"":"px")}}function c(t,e,n){if(t){var i=t.getElementsByTagName(e),o=0,a=i.length;if(n)for(;o<a;o++)n(i[o],o);return i}return[]}function d(t,e,n,i,o,a,r,s){t=t||e[V];var l=z.createEvent("Event"),c=t.options,d="on"+n.charAt(0).toUpperCase()+n.substr(1);l.initEvent(n,!0,!0),l.to=o||e,l.from=a||e,l.item=i||e,l.clone=S,l.oldIndex=r,l.newIndex=s,e.dispatchEvent(l),c[d]&&c[d].call(t,l)}function h(t,e,n,i,o,a,r,s){var l,c,d=t[V],h=d.options.onMove;return l=z.createEvent("Event"),l.initEvent("move",!0,!0),l.to=e,l.from=t,l.dragged=n,l.draggedRect=i,l.related=o||e,l.relatedRect=a||e.getBoundingClientRect(),l.willInsertAfter=s,t.dispatchEvent(l),h&&(c=h.call(d,l,r)),c}function u(t){t.draggable=!1}function f(){tt=!1}function p(t,e){var n=t.lastElementChild,i=n.getBoundingClientRect();return e.clientY-(i.top+i.height)>5||e.clientX-(i.left+i.width)>5}function g(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function v(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"===t.nodeName.toUpperCase()||">*"!==e&&!m(t,e)||n++;return n}function m(t,e){if(t){e=e.split(".");var n=e.shift().toUpperCase(),i=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");return!(""!==n&&t.nodeName.toUpperCase()!=n||e.length&&((" "+t.className+" ").match(i)||[]).length!=e.length)}return!1}function b(t,e){var n,i;return function(){void 0===n&&(n=arguments,i=this,setTimeout(function(){1===n.length?t.call(i,n[0]):t.apply(i,n),n=void 0},e))}}function _(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function D(t){return Z&&Z.dom?Z.dom(t).cloneNode(!0):Q?Q(t).clone(!0)[0]:t.cloneNode(!0)}function y(t){for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var i=e[n];i.checked&&it.push(i)}}if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var w,T,C,S,E,x,N,k,B,Y,O,X,A,M,P,R,I,L,F,U,j={},H=/\s+/g,W=/left|right|inline/,V="Sortable"+(new Date).getTime(),q=window,z=q.document,G=q.parseInt,Q=q.jQuery||q.Zepto,Z=q.Polymer,J=!1,K=!!("draggable"in z.createElement("div")),$=function(t){return!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie)/i)&&(t=z.createElement("x"),t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents)}(),tt=!1,et=Math.abs,nt=Math.min,it=[],ot=[],at=b(function(t,e,n){if(n&&e.scroll){var i,o,a,r,s,l,c=n[V],d=e.scrollSensitivity,h=e.scrollSpeed,u=t.clientX,f=t.clientY,p=window.innerWidth,g=window.innerHeight;if(B!==n&&(k=e.scroll,B=n,Y=e.scrollFn,!0===k)){k=n;do{if(k.offsetWidth<k.scrollWidth||k.offsetHeight<k.scrollHeight)break}while(k=k.parentNode)}k&&(i=k,o=k.getBoundingClientRect(),a=(et(o.right-u)<=d)-(et(o.left-u)<=d),r=(et(o.bottom-f)<=d)-(et(o.top-f)<=d)),a||r||(a=(p-u<=d)-(u<=d),r=(g-f<=d)-(f<=d),(a||r)&&(i=q)),j.vx===a&&j.vy===r&&j.el===i||(j.el=i,j.vx=a,j.vy=r,clearInterval(j.pid),i&&(j.pid=setInterval(function(){return l=r?r*h:0,s=a?a*h:0,"function"==typeof Y?Y.call(c,s,l,t):void(i===q?q.scrollTo(q.pageXOffset+s,q.pageYOffset+l):(i.scrollTop+=l,i.scrollLeft+=s))},24)))}},30),rt=function(t){function e(t,e){return void 0!==t&&!0!==t||(t=n.name),"function"==typeof t?t:function(n,i){var o=i.options.group.name;return e?t:t&&(t.join?t.indexOf(o)>-1:o==t)}}var n={},i=t.group;i&&"object"==typeof i||(i={name:i}),n.name=i.name,n.checkPull=e(i.pull,!0),n.checkPut=e(i.put),n.revertClone=i.revertClone,t.group=n};t.prototype={constructor:t,_onTapStart:function(t){var e,i=this,o=this.el,a=this.options,r=a.preventOnFilter,s=t.type,l=t.touches&&t.touches[0],c=(l||t).target,h=t.target.shadowRoot&&t.path&&t.path[0]||c,u=a.filter;if(y(o),!w&&!(/mousedown|pointerdown/.test(s)&&0!==t.button||a.disabled)&&!h.isContentEditable&&(c=n(c,a.draggable,o))&&N!==c){if(e=v(c,a.draggable),"function"==typeof u){if(u.call(this,t,c,this))return d(i,h,"filter",c,o,o,e),void(r&&t.preventDefault())}else if(u&&(u=u.split(",").some(function(t){if(t=n(h,t.trim(),o))return d(i,t,"filter",c,o,o,e),!0})))return void(r&&t.preventDefault());a.handle&&!n(h,a.handle,o)||this._prepareDragStart(t,l,c,e)}},_prepareDragStart:function(t,e,n,i){var o,r=this,l=r.el,h=r.options,f=l.ownerDocument;n&&!w&&n.parentNode===l&&(L=t,E=l,w=n,T=w.parentNode,x=w.nextSibling,N=n,R=h.group,M=i,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,w.style["will-change"]="all",o=function(){r._disableDelayedDrag(),w.draggable=r.nativeDraggable,s(w,h.chosenClass,!0),r._triggerDragStart(t,e),d(r,E,"choose",w,E,E,M)},h.ignore.split(",").forEach(function(t){c(w,t.trim(),u)}),a(f,"mouseup",r._onDrop),a(f,"touchend",r._onDrop),a(f,"touchcancel",r._onDrop),a(f,"pointercancel",r._onDrop),a(f,"selectstart",r),h.delay?(a(f,"mouseup",r._disableDelayedDrag),a(f,"touchend",r._disableDelayedDrag),a(f,"touchcancel",r._disableDelayedDrag),a(f,"mousemove",r._disableDelayedDrag),a(f,"touchmove",r._disableDelayedDrag),a(f,"pointermove",r._disableDelayedDrag),r._dragStartTimer=setTimeout(o,h.delay)):o())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),r(t,"mouseup",this._disableDelayedDrag),r(t,"touchend",this._disableDelayedDrag),r(t,"touchcancel",this._disableDelayedDrag),r(t,"mousemove",this._disableDelayedDrag),r(t,"touchmove",this._disableDelayedDrag),r(t,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(t,e){e=e||("touch"==t.pointerType?t:null),e?(L={target:w,clientX:e.clientX,clientY:e.clientY},this._onDragStart(L,"touch")):this.nativeDraggable?(a(w,"dragend",this),a(E,"dragstart",this._onDragStart)):this._onDragStart(L,!0);try{z.selection?setTimeout(function(){z.selection.empty()}):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(){if(E&&w){var e=this.options;s(w,e.ghostClass,!0),s(w,e.dragClass,!1),t.active=this,d(this,E,"start",w,E,E,M)}else this._nulling()},_emulateDragOver:function(){if(F){if(this._lastX===F.clientX&&this._lastY===F.clientY)return;this._lastX=F.clientX,this._lastY=F.clientY,$||l(C,"display","none");var t=z.elementFromPoint(F.clientX,F.clientY),e=t,n=ot.length;if(e)do{if(e[V]){for(;n--;)ot[n]({clientX:F.clientX,clientY:F.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);$||l(C,"display","")}},_onTouchMove:function(e){if(L){var n=this.options,i=n.fallbackTolerance,o=n.fallbackOffset,a=e.touches?e.touches[0]:e,r=a.clientX-L.clientX+o.x,s=a.clientY-L.clientY+o.y,c=e.touches?"translate3d("+r+"px,"+s+"px,0)":"translate("+r+"px,"+s+"px)";if(!t.active){if(i&&nt(et(a.clientX-this._lastX),et(a.clientY-this._lastY))<i)return;this._dragStarted()}this._appendGhost(),U=!0,F=a,l(C,"webkitTransform",c),l(C,"mozTransform",c),l(C,"msTransform",c),l(C,"transform",c),e.preventDefault()}},_appendGhost:function(){if(!C){var t,e=w.getBoundingClientRect(),n=l(w),i=this.options;C=w.cloneNode(!0),s(C,i.ghostClass,!1),s(C,i.fallbackClass,!0),s(C,i.dragClass,!0),l(C,"top",e.top-G(n.marginTop,10)),l(C,"left",e.left-G(n.marginLeft,10)),l(C,"width",e.width),l(C,"height",e.height),l(C,"opacity","0.8"),l(C,"position","fixed"),l(C,"zIndex","100000"),l(C,"pointerEvents","none"),i.fallbackOnBody&&z.body.appendChild(C)||E.appendChild(C),t=C.getBoundingClientRect(),l(C,"width",2*e.width-t.width),l(C,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=t.dataTransfer,i=this.options;this._offUpEvents(),R.checkPull(this,this,w,t)&&(S=D(w),S.draggable=!1,S.style["will-change"]="",l(S,"display","none"),s(S,this.options.chosenClass,!1),E.insertBefore(S,w),d(this,E,"clone",w)),s(w,i.dragClass,!0),e?("touch"===e?(a(z,"touchmove",this._onTouchMove),a(z,"touchend",this._onDrop),a(z,"touchcancel",this._onDrop),a(z,"pointermove",this._onTouchMove),a(z,"pointerup",this._onDrop)):(a(z,"mousemove",this._onTouchMove),a(z,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(n&&(n.effectAllowed="move",i.setData&&i.setData.call(this,n,w)),a(z,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(i){var o,a,r,s,c=this.el,d=this.options,u=d.group,g=t.active,v=R===u,m=!1,b=d.sort;if(void 0!==i.preventDefault&&(i.preventDefault(),!d.dragoverBubble&&i.stopPropagation()),!w.animated&&(U=!0,g&&!d.disabled&&(v?b||(s=!E.contains(w)):I===this||(g.lastPullMode=R.checkPull(this,g,w,i))&&u.checkPut(this,g,w,i))&&(void 0===i.rootEl||i.rootEl===this.el))){if(at(i,d,this.el),tt)return;if(o=n(i.target,d.draggable,c),a=w.getBoundingClientRect(),I!==this&&(I=this,m=!0),s)return e(g,!0),T=E,void(S||x?E.insertBefore(w,S||x):b||E.appendChild(w));if(0===c.children.length||c.children[0]===C||c===i.target&&p(c,i)){if(0!==c.children.length&&c.children[0]!==C&&c===i.target&&(o=c.lastElementChild),o){if(o.animated)return;r=o.getBoundingClientRect()}e(g,v),!1!==h(E,c,w,a,o,r,i)&&(w.contains(c)||(c.appendChild(w),T=c),this._animate(a,w),o&&this._animate(r,o))}else if(o&&!o.animated&&o!==w&&void 0!==o.parentNode[V]){O!==o&&(O=o,X=l(o),A=l(o.parentNode)),r=o.getBoundingClientRect();var _=r.right-r.left,D=r.bottom-r.top,y=W.test(X.cssFloat+X.display)||"flex"==A.display&&0===A["flex-direction"].indexOf("row"),N=o.offsetWidth>w.offsetWidth,k=o.offsetHeight>w.offsetHeight,B=(y?(i.clientX-r.left)/_:(i.clientY-r.top)/D)>.5,Y=o.nextElementSibling,M=!1;if(y){var P=w.offsetTop,L=o.offsetTop;M=P===L?o.previousElementSibling===w&&!N||B&&N:o.previousElementSibling===w||w.previousElementSibling===o?(i.clientY-r.top)/D>.5:L>P}else m||(M=Y!==w&&!k||B&&k);var F=h(E,c,w,a,o,r,i,M);!1!==F&&(1!==F&&-1!==F||(M=1===F),tt=!0,setTimeout(f,30),e(g,v),w.contains(c)||(M&&!Y?c.appendChild(w):o.parentNode.insertBefore(w,M?Y:o)),T=w.parentNode,this._animate(a,w),this._animate(r,o))}}},_animate:function(t,e){var n=this.options.animation;if(n){var i=e.getBoundingClientRect();1===t.nodeType&&(t=t.getBoundingClientRect()),l(e,"transition","none"),l(e,"transform","translate3d("+(t.left-i.left)+"px,"+(t.top-i.top)+"px,0)"),e.offsetWidth,l(e,"transition","all "+n+"ms"),l(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){l(e,"transition",""),l(e,"transform",""),e.animated=!1},n)}},_offUpEvents:function(){var t=this.el.ownerDocument;r(z,"touchmove",this._onTouchMove),r(z,"pointermove",this._onTouchMove),r(t,"mouseup",this._onDrop),r(t,"touchend",this._onDrop),r(t,"pointerup",this._onDrop),r(t,"touchcancel",this._onDrop),r(t,"pointercancel",this._onDrop),r(t,"selectstart",this)},_onDrop:function(e){var n=this.el,i=this.options;clearInterval(this._loopId),clearInterval(j.pid),clearTimeout(this._dragStartTimer),r(z,"mousemove",this._onTouchMove),this.nativeDraggable&&(r(z,"drop",this),r(n,"dragstart",this._onDragStart)),this._offUpEvents(),e&&(U&&(e.preventDefault(),!i.dropBubble&&e.stopPropagation()),C&&C.parentNode&&C.parentNode.removeChild(C),E!==T&&"clone"===t.active.lastPullMode||S&&S.parentNode&&S.parentNode.removeChild(S),w&&(this.nativeDraggable&&r(w,"dragend",this),u(w),w.style["will-change"]="",s(w,this.options.ghostClass,!1),s(w,this.options.chosenClass,!1),d(this,E,"unchoose",w,T,E,M),E!==T?(P=v(w,i.draggable))>=0&&(d(null,T,"add",w,T,E,M,P),d(this,E,"remove",w,T,E,M,P),d(null,T,"sort",w,T,E,M,P),d(this,E,"sort",w,T,E,M,P)):w.nextSibling!==x&&(P=v(w,i.draggable))>=0&&(d(this,E,"update",w,T,E,M,P),d(this,E,"sort",w,T,E,M,P)),t.active&&(null!=P&&-1!==P||(P=M),d(this,E,"end",w,T,E,M,P),this.save()))),this._nulling()},_nulling:function(){E=w=T=C=x=S=N=k=B=L=F=U=P=O=X=I=R=t.active=null,it.forEach(function(t){t.checked=!0}),it.length=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragover":case"dragenter":w&&(this._onDragOver(t),o(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],i=this.el.children,o=0,a=i.length,r=this.options;o<a;o++)t=i[o],n(t,r.draggable,this.el)&&e.push(t.getAttribute(r.dataIdAttr)||g(t));return e},sort:function(t){var e={},i=this.el;this.toArray().forEach(function(t,o){var a=i.children[o];n(a,this.options.draggable,i)&&(e[t]=a)},this),t.forEach(function(t){e[t]&&(i.removeChild(e[t]),i.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return n(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;return void 0===e?n[t]:(n[t]=e,void("group"===t&&rt(n)))},destroy:function(){var t=this.el;t[V]=null,r(t,"mousedown",this._onTapStart),r(t,"touchstart",this._onTapStart),r(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(r(t,"dragover",this),r(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),ot.splice(ot.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},a(z,"touchmove",function(e){t.active&&e.preventDefault()});try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){J={capture:!1,passive:!1}}}))}catch(t){}return t.utils={on:a,off:r,css:l,find:c,is:function(t,e){return!!n(t,e,t)},extend:_,throttle:b,closest:n,toggleClass:s,clone:D,index:v},t.create=function(e,n){return new t(e,n)},t.version="1.6.1",t});