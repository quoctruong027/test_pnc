"use strict";function viwpvs_set_swatches_position(i){if(i=jQuery(i),-1!==jQuery.inArray(viwpvs_frontend_loop_product_params.theme,["infinite","infinite-child"])){let t=i.closest(".gdlr-core-item-list");if(viwpvs_frontend_loop_product_params.theme_swatches_pos){let o=i.clone(),_=t.find(".gdlr-core-product-grid-content-wrap .gdlr-core-product-grid-content");i.remove(),_.append('<span class="vi_wpvs_loop_variation_price vi_wpvs_loop_variation_hidden"></span>'),"after_price"===viwpvs_frontend_loop_product_params.theme_swatches_pos?o.appendTo(_):o.prependTo(_),i=o}}return i}function viwpvs_fixed(){-1!==jQuery.inArray(viwpvs_frontend_loop_product_params.theme,["flatsome"])&&jQuery(document).on("append.infiniteScroll",function(i,t,o,_){let a=jQuery(_).find(".vi_wpvs_loop_variation_form:not(.vi_wpvs_loop_variation_form_check)");a.length>0&&a.each(function(){jQuery(this).removeClass("vi-wpvs-hidden").addClass("vi_wpvs_loop_variation_form_check vi_wpvs_variation_form").wpvs_get_variation().viwpvs_woo_product_variation_swatches()})})}jQuery(document).ready(function(){jQuery(".vi_wpvs_loop_variation_form:not(.vi_wpvs_loop_variation_form_check)").each(function(){let i=viwpvs_set_swatches_position(jQuery(this));i.removeClass("vi-wpvs-hidden").addClass("vi_wpvs_loop_variation_form_check").wpvs_get_variation(),i.addClass("vi_wpvs_variation_form vi_wpvs_variation_form_init").viwpvs_woo_product_variation_swatches()}),viwpvs_frontend_loop_product_params.viwpvs_position&&jQuery.ajaxSetup({beforeSend:function(){"string"==typeof this.data&&(this.data+="&viwpvs_position="+viwpvs_frontend_loop_product_params.viwpvs_position)}}),jQuery(document).on("ajaxComplete",function(i,t,o){return jQuery(".vi_wpvs_loop_variation_form:not(.vi_wpvs_loop_variation_form_check)").each(function(){let i=viwpvs_set_swatches_position(jQuery(this));i.removeClass("vi-wpvs-hidden").addClass("vi_wpvs_loop_variation_form_check").wpvs_get_variation(),i.addClass("vi_wpvs_variation_form vi_wpvs_variation_form_init").viwpvs_woo_product_variation_swatches()}),!1}),viwpvs_fixed()}),jQuery(window).load(function(){jQuery(".vi_wpvs_loop_variation_form:not(.vi_wpvs_loop_variation_form_check)").each(function(){let i=viwpvs_set_swatches_position(jQuery(this));i.removeClass("vi-wpvs-hidden").addClass("vi_wpvs_loop_variation_form_check").wpvs_get_variation(),i.addClass("vi_wpvs_variation_form vi_wpvs_variation_form_init").viwpvs_woo_product_variation_swatches()})});var viwpvs_get_variations=function(i){this.is_atc=viwpvs_frontend_loop_product_params.is_atc,this.wc_ajax_url=viwpvs_frontend_loop_product_params.wc_ajax_url,this.swatches=i,this.product_id=parseInt(i.data("product_id")),this.variation=i.data("product_variations"),this.is_find_variation=i.data("vpvs_find_variation"),this.is_ajax=!this.variation,this.xhr=!1,this.init()};viwpvs_get_variations.prototype.init=function(){let i,t,o,_=this,a=this.swatches,e=this.variation,r=this.swatches.find("select"),n={},s=0;(i=a.closest(".product")).length||(i=a.closest(".gdlr-core-item-list")),t=jQuery(_.get_img_product(a)),o=t.attr("data-src")||t.attr("src")||t.attr("content")||t.attr("srcset")||"",r.each(function(){let i=jQuery(this).val();i&&s++,n[jQuery(this).data("attribute_name")]=i}),s>0&&_.find_variation(n,e,i,t,o,!0),r.on("change",function(r){n[jQuery(this).data("attribute_name")]=jQuery(this).val(),t=_.get_img_product(a,!0),_.find_variation(n,e,i,t,o)}),i.find(".vi_wpvs_loop_atc_button").on("click",function(){if(jQuery(this).hasClass("vi_wpvs_loop_variation_no_pointer"))return!1;i.find(".viwcuf_product_qty_tooltip").addClass("vi_wpvs_loop_variation_hidden");let t=jQuery(this),o=a.serialize();if(i.find(".viwcuf_product_qty").length>0){let t=parseInt(i.find(".viwcuf_product_qty").val()||0),_=parseInt(i.find(".viwcuf_product_qty").attr("min")||1),a=parseInt(i.find(".viwcuf_product_qty").attr("max")||0);if(0===t)return!1;if(t<_)return i.find(".viwcuf_product_qty_tooltip").removeClass("vi_wpvs_loop_variation_hidden").html(viwpvs_frontend_loop_product_params.less_min_qty+" "+_+"."),setTimeout(function(){i.find(".viwcuf_product_qty_tooltip").addClass("vi_wpvs_loop_variation_hidden")},2e3),!1;if(a>0&&t>a)return i.find(".viwcuf_product_qty_tooltip").removeClass("vi_wpvs_loop_variation_hidden").html(viwpvs_frontend_loop_product_params.greater_max_qty+" "+a+"."),setTimeout(function(){i.find(".viwcuf_product_qty_tooltip").addClass("vi_wpvs_loop_variation_hidden")},2e3),!1;o+="&quantity="+t}jQuery.ajax({type:"post",url:_.wc_ajax_url.toString().replace("%%endpoint%%","wpvs_add_to_cart"),data:o,beforeSend:function(i){t.removeClass("added").addClass("loading")},complete:function(i){t.removeClass("loading").addClass("added")},success:function(i){if(i.error&&i.product_url)return window.location=i.product_url,!1;jQuery(document.body).trigger("added_to_cart",[i.fragments,i.cart_hash,t]),jQuery(document.body).trigger("wc_fragments_refreshed"),jQuery(document.body).trigger("update_checkout"),jQuery(document.body).trigger("viwpvs_added_to_cart",[i,t])}})})},viwpvs_get_variations.prototype.find_variation=function(i,t,o,_,a,e=!1){let r,n,s,v=this,p=v.swatches,d=[];if(v.is_ajax){if(!v.is_find_variation){if(e)return p.find(".vi-wpvs-option-wrap-selected").removeClass("vi-wpvs-option-wrap-selected").addClass("vi-wpvs-option-wrap-default"),p.find(".vi-wpvs-select-attribute  select").each(function(){jQuery(this).val("").trigger("change")}),!1;if(_){let i=p.find(".vi-wpvs-option-wrap-selected img").data("loop_src");i&&(jQuery(_).parent().is("picture")&&jQuery(_).parent().find("source").each(function(t,o){jQuery(o).attr({srcset:i})}),_.attr({src:i,srcset:i}))}return!1}if(v.xhr&&v.xhr.abort(),jQuery.each(i,function(i,t){if(!t)return s=!0,!1}),s)return!1;v.variation?(t=v.variation,jQuery.each(t,function(t,o){if(v.check_is_equal(i,o.attributes))return r=o,!1}),r?(_&&(jQuery(_).parent().is("picture")&&jQuery(_).parent().find("source").each(function(i,t){jQuery(t).attr({srcset:r.image.thumb_src})}),_.attr({src:r.image.thumb_src,srcset:r.image.thumb_src})),r.price_html&&(o.find(".price:not(.vi_wpvs_loop_variation_price),.gdlr-core-product-price:not(.vi_wpvs_loop_variation_price)").addClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_variation_price").removeClass("vi_wpvs_loop_variation_hidden").html(r.price_html)),v.is_atc&&(r.is_in_stock?(v.set_add_to_cart(r.variation_id,p),o.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden vi_wpvs_loop_variation_no_pointer"),o.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_action .viwcuf_product_qty").attr({min:r.min_qty,max:r.max_qty})):(v.set_add_to_cart("",p),o.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden").addClass("vi_wpvs_loop_variation_no_pointer"),o.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden")))):t.length<parseInt(p.data("variation_count"))?v.call_ajax(i,v,t,_,a,o,p):(_&&(jQuery(_).parent().is("picture")&&jQuery(_).parent().find("source").each(function(i,t){jQuery(t).attr({srcset:a})}),_.attr({src:a,srcset:a})),o.find(".price:not(.vi_wpvs_loop_variation_price),.gdlr-core-product-price:not(.vi_wpvs_loop_variation_price)").removeClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_variation_price").addClass("vi_wpvs_loop_variation_hidden"),v.is_atc&&(v.set_add_to_cart("",p),o.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden").addClass("vi_wpvs_loop_variation_no_pointer"),o.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden")))):(t=[],v.call_ajax(i,v,t,_,a,o,p))}else{if(1===(n=Object.getOwnPropertyNames(i)).length)jQuery.each(t,function(i,t){let o=t.attributes[n[0]];o&&-1===d.indexOf(o)&&d.push(o)}),d.length>0&&(d.push(""),p.find("select option").each(function(i,t){let o=jQuery(t).val().toString();-1===jQuery.inArray(o,d)&&jQuery(t).addClass("vi-wpvs-option-disabled")}));else{let o=[];for(let _=0;_<n.length;_++){let a=n[_],e=i[a];if(!e||""===e){s=!0;for(let i=0;i<n.length;i++){if(_==i)continue;let t=n[i];p.find('.vi-wpvs-select-attribute select[name="'+t+'"] option').removeClass("vi-wpvs-option-disabled")}}jQuery.each(t,function(i,t){if(!t.attributes[a])return p.find('select[name ="'+a+'"]').addClass("vi-wpvs-select-option-show"),!0;if(-1===o.indexOf(t.attributes[a])&&o.push(t.attributes[a]),e==t.attributes[a]){p.find('option[value ="'+t.attributes[a]+'"]').removeClass("vi-wpvs-option-disabled"),-1===d.indexOf(t.attributes[a])&&d.push(t.attributes[a]);for(let i=0;i<n.length;i++){let _=n[i];t.attributes[_]&&_!==a&&(p.find('option[value ="'+t.attributes[_]+'"]').removeClass("vi-wpvs-option-disabled"),-1===d.indexOf(t.attributes[_])&&d.push(t.attributes[_]),-1===o.indexOf(t.attributes[_])&&o.push(t.attributes[_]))}}else for(let i=0;i<n.length;i++){let o=n[i];""===t.attributes[o]||null===t.attributes[o]?p.find('select[name ="'+o+'"]').addClass("vi-wpvs-select-option-show"):""!==e&&null!==e&&o!==a&&-1===d.indexOf(t.attributes[o])&&p.find('option[value ="'+t.attributes[o]+'"]').addClass("vi-wpvs-option-disabled")}})}o.length>0&&(o.push(""),p.find(".vi-wpvs-select-attribute select:not(.vi-wpvs-select-option-show) option").each(function(i,t){let _=jQuery(t).val().toString();-1===jQuery.inArray(_,o)&&jQuery(t).addClass("vi-wpvs-option-disabled")})),p.find(".vi-wpvs-select-attribute select").removeClass("vi-wpvs-select-option-show")}if(!v.is_find_variation){if(e)return p.find(".vi-wpvs-option-wrap-selected").removeClass("vi-wpvs-option-wrap-selected").addClass("vi-wpvs-option-wrap-default"),p.find("select").each(function(i,t){jQuery(t).val("")}),!1;if(_){let i=p.find(".vi-wpvs-option-wrap-selected img").data("loop_src");i&&(jQuery(_).parent().is("picture")&&jQuery(_).parent().find("source").each(function(t,o){jQuery(o).attr({srcset:i})}),_.attr({src:i,srcset:i}))}return!1}s||jQuery.each(t,function(t,o){if(v.check_is_equal(i,o.attributes))return r=o,!1}),r?(_&&(jQuery(_).parent().is("picture")&&jQuery(_).parent().find("source").each(function(i,t){jQuery(t).attr({srcset:r.image.thumb_src})}),_.attr({src:r.image.thumb_src,srcset:r.image.thumb_src})),r.price_html&&(o.find(".price:not(.vi_wpvs_loop_variation_price),.gdlr-core-product-price:not(.vi_wpvs_loop_variation_price)").addClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_variation_price").removeClass("vi_wpvs_loop_variation_hidden").html(r.price_html)),v.is_atc&&(r.is_in_stock?(v.set_add_to_cart(r.variation_id,p),o.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden vi_wpvs_loop_variation_no_pointer"),o.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_action .viwcuf_product_qty").attr({min:r.min_qty,max:r.max_qty})):(v.set_add_to_cart("",p),o.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden").addClass("vi_wpvs_loop_variation_no_pointer"),o.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden")))):(_&&(jQuery(_).parent().is("picture")&&jQuery(_).parent().find("source").each(function(i,t){jQuery(t).attr({srcset:a})}),_.attr({src:a,srcset:a})),o.find(".price:not(.vi_wpvs_loop_variation_price),.gdlr-core-product-price:not(.vi_wpvs_loop_variation_price)").removeClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_variation_price").addClass("vi_wpvs_loop_variation_hidden"),v.is_atc&&(v.set_add_to_cart("",p),o.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),o.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden").addClass("vi_wpvs_loop_variation_no_pointer"),o.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden")))}},viwpvs_get_variations.prototype.call_ajax=function(i,t,o,_,a,e,r){i.product_id=t.product_id,t.xhr=jQuery.ajax({url:t.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:i,beforeSend:function(){r.find(".vi_wpvs_loop_variation_form_loading").removeClass("vi_wpvs_loop_variation_form_loading_hidden").addClass("vi_wpvs_loop_variation_form_loading_visible")},success:function(n){n?(_&&(jQuery(_).parent().is("picture")&&jQuery(_).parent().find("source").each(function(i,t){jQuery(t).attr({srcset:n.image.thumb_src})}),_.attr({src:n.image.thumb_src,srcset:n.image.thumb_src})),n.price_html&&(e.find(".price:not(.vi_wpvs_loop_variation_price),.gdlr-core-product-price:not(.vi_wpvs_loop_variation_price)").addClass("vi_wpvs_loop_variation_hidden"),e.find(".vi_wpvs_loop_variation_price").removeClass("vi_wpvs_loop_variation_hidden").html(n.price_html)),t.is_atc&&(n.is_in_stock?(t.set_add_to_cart(n.variation_id,r),e.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),e.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden vi_wpvs_loop_variation_no_pointer"),e.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden"),e.find(".vi_wpvs_loop_action .viwcuf_product_qty").attr({min:n.min_qty,max:n.max_qty})):(t.set_add_to_cart("",r),e.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),e.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden").addClass("vi_wpvs_loop_variation_no_pointer"),e.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden"))),o[o.length||0]=n,t.variation=o):(_&&(jQuery(_).parent().is("picture")&&jQuery(_).parent().find("source").each(function(i,t){jQuery(t).attr({srcset:a})}),_.attr({src:a,srcset:a})),e.find(".price:not(.vi_wpvs_loop_variation_price),.gdlr-core-product-price:not(.vi_wpvs_loop_variation_price)").removeClass("vi_wpvs_loop_variation_hidden"),e.find(".vi_wpvs_loop_variation_price").addClass("vi_wpvs_loop_variation_hidden"),t.is_atc&&(t.set_add_to_cart("",r),e.find(".add_to_cart_button:not(.vi_wpvs_loop_atc_button)").addClass("vi_wpvs_loop_variation_hidden"),e.find(".vi_wpvs_loop_atc_button").removeClass("vi_wpvs_loop_variation_hidden").addClass("vi_wpvs_loop_variation_no_pointer"),e.find(".vi_wpvs_loop_action").removeClass("vi_wpvs_loop_variation_hidden"))),delete i.product_id},complete:function(){r.find(".vi_wpvs_loop_variation_form_loading").removeClass("vi_wpvs_loop_variation_form_loading_visible").addClass("vi_wpvs_loop_variation_form_loading_hidden")}})},viwpvs_get_variations.prototype.check_is_equal=function(i,t){let o,_=Object.getOwnPropertyNames(i),a=Object.getOwnPropertyNames(t);if(_.length!=a.length)return!1;for(o=0;o<_.length;o++){let a=_[o];if(t[a]&&i[a]!==t[a])return!1}return!0},viwpvs_get_variations.prototype.set_add_to_cart=function(i,t){t.find(".variation_id").val(i)},viwpvs_get_variations.prototype.get_img_product=function(i,t=!1){let o,_=i.closest(".product");return _.length||(_=i.closest(".gdlr-core-item-list")),_.length||(_=i.closest(".product-warp-item")),t&&window.outerWidth>549&&_.find("img.show-on-hover").length?o=_.find("img.show-on-hover").first():_.find(".attachment-shop_catalog").length?o=_.find(".attachment-shop_catalog").first():_.find(".gdlr-core-product-thumbnail").length?o=_.find(".gdlr-core-product-thumbnail").first():_.find(".woo-entry-image-main").length?o=_.find(".woo-entry-image-main").first():_.find(".wp-post-image.vi-load").length?o=_.find(".wp-post-image.vi-load ").first():_.find(".attachment-woocommerce_thumbnail").length?o=_.find(".attachment-woocommerce_thumbnail").first():_.find(".wp-post-image").length&&(o=_.find(".wp-post-image").first()),o||(o=!(!_||!_.find("img"))&&_.find("img").first()),o&&o.find("img").length>0&&(o=o.find("img").first()),o},jQuery.fn.wpvs_get_variation=function(){return new viwpvs_get_variations(this),this};