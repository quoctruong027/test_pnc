jQuery.fn.viwcaio_get_variations=function(t){return new viwcaio_get_variation(this,t),this};var viwcaio_get_variation=function(t,i){this.wc_ajax_url=i.wc_ajax_url||"",this.form=t,this.product_id=parseInt(t.data("product_id")),this.variations=t.data("product_variations")||"",this.is_ajax=!this.variations,this.xhr=!1,this.init()};viwcaio_get_variation.prototype.init=function(){let t=this,i=this.form,a=this.variations,e=this.form.find(".vi-wcaio-attribute-options"),o={},n=0;e.each(function(){let t=jQuery(this).val();t&&n++,o[jQuery(this).data("attribute_name")]=t}),n>0?t.find_variation(o,a,i):i.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable"),e.on("change",function(e){o[jQuery(this).data("attribute_name")]=jQuery(this).val(),t.find_variation(o,a,i)})},viwcaio_get_variation.prototype.find_variation=function(t,i,a){let e,o,n,r=this,s=[];if(r.is_ajax){if(r.xhr&&r.xhr.abort(),jQuery.each(t,function(t,i){if(!i)return n=!0,!1}),n)return r.show_variation(r,null,a),!1;r.variations?(i=r.variations,jQuery.each(i,function(i,a){if(r.check_is_equal(t,a.attributes))return e=a,!1}),e?r.show_variation(r,e,a):i.length<parseInt(a.data("variation_count")||0)?r.call_ajax(t,i,a,r):r.show_variation(r,e,a)):(i=[],r.call_ajax(t,i,a,r))}else{if(1===(o=Object.getOwnPropertyNames(t)).length)jQuery.each(i,function(t,i){let a=i.attributes[o[0]];a&&-1===s.indexOf(a)&&s.push(a)}),s.length>0&&(s.push(""),a.find("select option").each(function(t,i){let a=jQuery(i).val().toString();-1===jQuery.inArray(a,s)&&jQuery(i).addClass("vi-wcaio-option-disabled")}));else{let e=[];for(let r=0;r<o.length;r++){let c=o[r],u=t[c];if(!u||""===u){n=!0;for(let t=0;t<o.length;t++){if(r===t)continue;let i=o[t];a.find('.vi-wcaio-swatches-wrap select[name="'+i+'"] option').removeClass("vi-wcaio-option-disabled")}}jQuery.each(i,function(t,i){if(!i.attributes[c])return!0;if(-1===e.indexOf(i.attributes[c])&&e.push(i.attributes[c]),u==i.attributes[c]){a.find('option[value ="'+i.attributes[c]+'"]').removeClass("vi-wcaio-option-disabled"),-1===s.indexOf(i.attributes[c])&&s.push(i.attributes[c]);for(let t=0;t<o.length;t++){let n=o[t];i.attributes[n]&&n!==c&&(a.find('option[value ="'+i.attributes[n]+'"]').removeClass("vi-wcaio-option-disabled"),-1===s.indexOf(i.attributes[n])&&s.push(i.attributes[n]),-1===e.indexOf(i.attributes[n])&&e.push(i.attributes[n]))}}else for(let t=0;t<o.length;t++){let e=o[t];""!==u&&null!==u&&e!==c&&-1===s.indexOf(i.attributes[e])&&a.find('option[value ="'+i.attributes[e]+'"]').addClass("vi-wcaio-option-disabled")}})}}n||jQuery.each(i,function(i,a){if(r.check_is_equal(t,a.attributes))return e=a,!1}),r.show_variation(r,e,a)}},viwcaio_get_variation.prototype.call_ajax=function(t,i,a,e){t.product_id=e.product_id,e.xhr=jQuery.ajax({url:e.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:t,beforeSend:function(){a.closest(".vi-wcaio-va-cart-form-wrap").addClass("vi-wcaio-container-loading")},success:function(o){e.show_variation(e,o,a),o&&(i[i.length||0]=o,e.variations=i),delete t.product_id},complete:function(){a.closest(".vi-wcaio-va-cart-form-wrap").removeClass("vi-wcaio-container-loading")}})},viwcaio_get_variation.prototype.show_variation=function(t,i,a){i&&i.is_in_stock?(t.set_add_to_cart(i.variation_id,a),a.find(".vi-wcaio-product-bt-atc").removeClass("vi-wcaio-button-swatches-disable")):(t.set_add_to_cart("",a),a.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable"))},viwcaio_get_variation.prototype.set_add_to_cart=function(t,i){t=t||0,i.find(".variation_id").val(t)},viwcaio_get_variation.prototype.check_is_equal=function(t,i){let a,e=Object.getOwnPropertyNames(t),o=Object.getOwnPropertyNames(i);if(e.length!==o.length)return!1;for(a=0;a<e.length;a++){let o=e[a];if(i[o]&&t[o]!==i[o])return!1}return!0};