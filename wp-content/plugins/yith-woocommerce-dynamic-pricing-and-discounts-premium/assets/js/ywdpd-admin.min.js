jQuery(function(r){"use strict";var t,e,d=r(document).find(".ywdpd-sections-group").find(".ywdpd-section"),n=d.find(".yith-ywdpd-eventype-select"),i="undefined"!=typeof yith_ywdpd_admin&&yith_ywdpd_admin.del_msg,a=yith_ywdpd_admin.ajaxurl+"?action=ywdpd_admin_action",l=function(t){t.each(function(){var d=r(this),t=d.data("field"),e=d.find("option:selected");o(d,e.val(),t),d.on("change",function(){var t=d.data("field"),e=d.find("option:selected");o(d,e.val(),t)})})},o=function(t,d,e){t.closest(".ywdpd-select-wrapper").find("tr.deps-"+e).each(function(){var t,e=r(this).data("type").split(";");-1!==r.inArray(d,e)?r(this).show():(r(this).hide(),void 0!==r(this).data("rel")&&(t="deps-"+r(this).data("rel"),r(this).parents(".ywdpd-section").find("."+t).hide()))})};r(document).on("click",".add-row",function(){var t=r(this),e=t.closest("table"),d=t.closest("tr"),a=parseInt(d.data("index")),n=d.clone(),i=e.find("tr"),o=1;n.find("select").removeClass("enhanced"),n.find("span.select2").remove(),i.each(function(){var t=r(this).data("index");o<t&&(o=t)});var c=o+1;n.attr("data-index",c),n.find("[name*='rules']").each(function(){var t=r(this),e=t.attr("name"),d=t.attr("id"),n=e.replace("[rules]["+a+"]","[rules]["+c+"]"),i=d.replace("[rules]["+a+"]","[rules]["+c+"]");t.attr("name",n),t.attr("id",i),t.val("")}),n.find(".remove-row").removeClass("hide-remove"),e.append(n),r(document.body).trigger("wc-enhanced-select-init");var s=n.find(".yith-ywdpd-eventype-select");l(s)}),r(document).on("click",".remove-row",function(){r(this).closest("tr").remove()}),r(".post-type-ywdpd_discount table.wp-list-table  tr.type-ywdpd_discount").append('<td class="column-handle"></td>'),r(".post-type-ywdpd_discount table.wp-list-table thead tr").append('<th class="manage-column" id="handle" scope="col"></th>'),r(".post-type-ywdpd_discount table.wp-list-table tfoot tr").append('<th class="manage-column" id="handle" scope="col"></th>'),jQuery(".ywdpd-sections-group").sortable({items:".ywdpd-section-handle",cursor:"move",axis:"y",handle:"form",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style");for(var d=r(".ywdpd-section-handle"),n=0,i=new Array,n=0;n<d.length;n++)i[n]=r(d[n]).data("key");0<i.length&&r.post(a,{ywdpd_action:"order_section",tab:r(".form-table").closest(".yit-admin-panel-content-wrap-full").data("type"),order_keys:i},function(t){})}}),l(n),d.find(".datepicker").each(function(){r(this).prop("placeholder","YYYY-MM-DD HH:mm")}).datetimepicker({timeFormat:"HH:mm",defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1}),r("#_discount_type").length&&(t=r("#_discount_type").data("std"),e=r(".page-title-action").attr("href"),r("#_discount_type").attr("value",t),r(".page-title-action").attr("href",e+"&ywdpd_discount_type="+t)),r("#_schedule_from, #_schedule_to").each(function(){r(this).prop("placeholder","YYYY-MM-DD HH:mm")}).datetimepicker({timeFormat:"HH:mm",defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1});var c,s,p,u,y,f=r("#ywdpd_cart_discount").find(".yith-ywdpd-eventype-select");l(f),r(".post-type-ywdpd_discount table.wp-list-table").sortable({items:"tbody tr:not(.inline-edit-row)",cursor:"move",handle:".column-handle",axis:"y",forcePlaceholderSize:!0,helper:"clone",opacity:.65,start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style");var d=e.item.find(".check-column input").val(),n=e.item.prev().find(".check-column input").val(),i=e.item.next().find(".check-column input").val();r.post(a,{ywdpd_action:"table_order_section",type:r(document).find("body").hasClass("ywdpd-discount-type-cart")?"cart":"pricing",roleid:d,previd:n,nextid:i},function(t){})}}),r("#ywdpd-discount-list-table").on("submit",function(){if("delete"==r(this).find("#bulk-action-selector-top").val())return 1==window.confirm(i)}),r(".cart_discount,.cart_discount_type").show(),r(document).on("change",".ywdpd-toggle-enabled input",function(){var t="yes"===r(this).val()?"yes":"no",e=r(this).closest(".ywdpd-toggle-enabled"),d=e.data("discount-id"),n=e.data("security");r.ajax({type:"POST",data:{ywdpd_action:"discount_toggle_enabled",id:d,enabled:t,security:n},url:a,success:function(t){"undefined"!=typeof t.error&&alert(t.error)}})}),r(document).find("body").hasClass("post-type-ywdpd_discount")&&(c=r(".subsubsub").find("li a"),s=r(".row-actions"),p="",r(document).find("body").hasClass("ywdpd-discount-type-cart")&&(p="cart"),r(document).find("body").hasClass("ywdpd-discount-type-pricing")&&(p="pricing"),0<r(document).find("#ywdpd_discount_type").length&&(p=r(document).find("#ywdpd_discount_type").val()),r.each(c,function(){var t=r(this),e=t.attr("href");e+="&ywdpd_discount_type="+p,t.attr("href",e)}),r.each(s,function(){var t=r(this).find("a");r.each(t,function(){var t=r(this),e=t.attr("href");e+="&ywdpd_discount_type="+p,t.attr("href",e)})}),0<(u=r(document).find("a.page-title-action")).length&&r.each(u,function(){var t=r(this),e=t.attr("href");e+="&ywdpd_discount_type="+p,t.attr("href",e)}),y=r(document).find("#posts-filter"),r("<input>").attr({type:"hidden",value:p,name:"ywdpd_discount_type"}).appendTo(y)),r(document).find(".ui-datepicker").addClass("yith-plugin-fw-datepicker-div")});