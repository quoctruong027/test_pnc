jQuery(function(_){var e=_(document).find(".ywdpd_popup"),o={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0},a=function(){e.fadeOut(300),_(document).trigger("wc_update_cart")},c=function(d){var t=d.data("allowed_items")-1;d.data("allowed_items",t),0<t?d.find(".ywdpd_quantity").html(t):d.addClass("hide_rule"),_(document).trigger("ywdpd_counter_updated",[t,d])},d=function(){e.find(".ywdpd_product_stage").each(function(){var d=_(this).find(".ywdpd_products.owl-carousel"),t=3<(t=d.find("li").size())?3:t;d.owlCarousel({loop:!1,margin:10,nav:!1,responsive:{0:{items:1},600:{items:t},1e3:{items:t}}}),d.on("onInitialized",setTimeout(function(){n()},500))})},r=function(){e.find(".ywdpd_step2").fadeOut(300,function(){e.find(".ywdpd_step1").fadeIn(300),e.find(".ywdpd_step2").html("")})},n=function(){var d=e.find(".ywdpd_popup_wrapper"),t=d.outerWidth(),n=d.outerHeight(),a=_(window).width(),i=_(window).height();d.css({position:"fixed",top:(i-n)/2+"px",left:(a-t)/2+"px"})};d(),e.fadeIn(300),e.on("click",".ywdpd_close",a),e.on("click",".ywdpd_step1 ul.ywdpd_products.products li a",function(d){d.preventDefault();var t,n=_(this).parent(),a=n.data("product_id"),i=n.data("ywdpd_rule_id");"simple"===n.data("product_type")?(t={product_id:a=n.data("product_id"),rule_id:i=n.data("ywdpd_rule_id"),action:ywdpd_popup_args.actions.add_gift_to_cart},_.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:t,dataType:"json",beforeSend:function(){n.parents(".ywdpd_product_stage").block(o)},success:function(d){n.addClass("added"),c(_(document).find("#ywdpd_single_rule_"+i))},complete:function(){n.parents(".ywdpd_product_stage").unblock()}})):(t={product_id:a,rule_id:i,action:ywdpd_popup_args.actions.show_second_step},_.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:t,dataType:"json",beforeSend:function(){n.find("img.ywdpd_loader").show()},success:function(d){var t;""!==d.template&&(t=d.template,e.find(".ywdpd_step1").fadeOut(300,function(){e.find(".ywdpd_step2").html(t),e.find(".ywdpd_step2 .variations_form").each(function(){_(this).wc_variation_form()}),p(),u(),e.find(".ywdpd_step2").fadeIn(300)}))},complete:function(){n.find("img.ywdpd_loader").hide()}}))});var p=function(){_(".variations_form.cart").on("found_variation",function(d,t){var n=_(this),a={ywdp_check_rule_id:_(this).parent().find(".ywdpd_rule_id").val(),product_id:t.variation_id,action:ywdpd_popup_args.actions.check_variable};_.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:a,dataType:"json",beforeSend:function(){n.block(o)},success:function(d){d.variation_found?_(".ywdpd_add_to_gift").attr("disabled",!0):_(".ywdpd_add_to_gift").attr("disabled",!1)},complete:function(){n.unblock()}})}).on("reset_data",function(d){_(".ywdpd_add_to_gift").attr("disabled",!0)})},u=function(){_(document).on("click",".ywdpd_add_to_gift",function(d){d.preventDefault();var t,n,a=_('input[name="product_id"]'),i=_("input.variation_id"),e=(t=_(document).find('select[name^="attribute"]'),n={},t.each(function(){var d=_(this),t=d.attr("name");n[t]=d.val()}),n),o=_("input.ywdpd_rule_id"),p={product_id:a.val(),variation_id:i.val(),rule_id:o.val(),variations:e,action:ywdpd_popup_args.actions.add_gift_to_cart},u=_(this);_.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:p,dataType:"json",beforeSend:function(){u.addClass("loading")},success:function(d){var t=_(document).find("#ywdpd_single_rule_"+o.val());t.find('ul.ywdpd_products li[data-product_id="'+a.val()+'"]').addClass("added"),c(t),r()},complete:function(){u.removeClass("loading")}})})};_(document).on("ywdpd_counter_updated",function(d,t,n){0==e.find(".ywdpd_single_rule_container").not(".hide_rule").size()?a():e.find(".ywdpd_single_rule_container.hide_rule").fadeOut(300)}),_(document).on("click",".ywdpd_back",function(d){r()}),_(document).on("click",".ywdpd_footer a",function(d){d.preventDefault(),a()}),_(document).on("keyup",function(d){27==d.keyCode&&a()}),_(window).on("resize",function(){n()})});