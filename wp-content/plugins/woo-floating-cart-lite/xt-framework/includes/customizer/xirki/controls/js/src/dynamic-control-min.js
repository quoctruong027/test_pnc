(function(){"use strict";wp.customize.xirkiDynamicControl=wp.customize.Control.extend({initialize:function(id,options){var control=this,args=options||{};args.params=args.params||{};if(!args.params.type){args.params.type="xirki-generic"}if(!args.params.content){args.params.content=jQuery("<li></li>");args.params.content.attr("id","customize-control-"+id.replace(/]/g,"").replace(/\[/g,"-"));args.params.content.attr("class","customize-control customize-control-"+args.params.type)}control.propertyElements=[];wp.customize.Control.prototype.initialize.call(control,id,args)},_setUpSettingRootLinks:function(){var control=this,nodes=control.container.find("[data-customize-setting-link]");nodes.each(function(){var node=jQuery(this);wp.customize(node.data("customizeSettingLink"),function(setting){var element=new wp.customize.Element(node);control.elements.push(element);element.sync(setting);element.set(setting())})})},_setUpSettingPropertyLinks:function(){var control=this,nodes;if(!control.setting){return}nodes=control.container.find("[data-customize-setting-property-link]");nodes.each(function(){var node=jQuery(this),element,propertyName=node.data("customizeSettingPropertyLink");element=new wp.customize.Element(node);control.propertyElements.push(element);element.set(control.setting()[propertyName]);element.bind(function(newPropertyValue){var newSetting=control.setting();if(newPropertyValue===newSetting[propertyName]){return}newSetting=_.clone(newSetting);newSetting[propertyName]=newPropertyValue;control.setting.set(newSetting)});control.setting.bind(function(newValue){if(newValue[propertyName]!==element.get()){element.set(newValue[propertyName])}})})},ready:function(){var control=this;control._setUpSettingRootLinks();control._setUpSettingPropertyLinks();wp.customize.Control.prototype.ready.call(control);control.deferred.embedded.done(function(){control.initXirkiControl(control)})},embed:function(){var control=this,sectionId=control.section();if(!sectionId){return}wp.customize.section(sectionId,function(section){if("xirki-expanded"===section.params.type||section.expanded()||wp.customize.settings.autofocus.control===control.id){control.actuallyEmbed()}else{section.expanded.bind(function(expanded){if(expanded){control.actuallyEmbed()}})}})},actuallyEmbed:function(){var control=this;if("resolved"===control.deferred.embedded.state()){return}control.renderContent();control.deferred.embedded.resolve()},focus:function(args){var control=this;control.actuallyEmbed();wp.customize.Control.prototype.focus.call(control,args)},initXirkiControl:function(control){if("undefined"!==typeof xirki.control[control.params.type]){xirki.control[control.params.type].init(control);return}this.container.on("change keyup paste click","input",function(){control.setting.set(jQuery(this).val())})}})})();_.each(xirki.control,function(obj,type){wp.customize.controlConstructor[type]=wp.customize.xirkiDynamicControl.extend({})});